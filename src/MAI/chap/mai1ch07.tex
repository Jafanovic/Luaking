% !TeX spellcheck = cs_CZ
%---------------------------------------------------------------------------------------------------
% file: mai1ch07.tex
%---------------------------------------------------------------------------------------------------
%============================ Primitivní funkce ====================================================
% \setcounter{chapter}{1000}
% \setcounter{page}{43210}
\setchaptertoc
\chapter{Poznáváme funkci z její derivace - neurčitý integrál}\label{mai:IchapVII}
  %----------------------------Neurčitý integrál----------------------------------------------------
  \section{Motivace}
    Problém \emph{neurčitého integrálu}, neboli \textbf{primitivní funkce}, lze vyložit velmi 
    jednoduše: Máme podezření, že zadaná funkce \(f(x)\) vznikla derivováním jisté, zatím neznámé, 
    funkce \(F(x)\). Dokážeme ji najít? 
  
    K danému problému můžeme přistupovat také fyzikálně: Zavedením pojmu derivace funkce jsme 
    motivovali důležitým požadavkem definovat okamžitou rychlost pohybu bodu po přímce. Existuje 
    přirozeně i požadavek opačný, tj. nalézt zákon dráhy pohybu bodu po přímce, je-li dána jeho 
    okamžitá rychlost jako funkce času \cite[s.~253]{Brabec1989}. Vše si ukážeme na následujícím 
    příkladu:      
    %-------------------------------------
    \input{../src/MAI/exam/exam117.tex}
    %-------------------------------------
    Každé takové funkci, jejíž derivací je daná funkce, budeme říkat \emph{primitivní funkce} k 
    dané funkci. Na uvedeném příkladě je patrné, že k dané funkci může existovat nekonečně mnoho 
    primitivních funkcí. Množinu všech primitivních funkcí se často nazývá \textbf{neurčitým 
    integrálem}. Po tomto názorném uvedení do problému přejděme k přesné formulaci základních pojmů.
    
  \section{Definice primitivní funkce}\label{mai:IchapVIIsecI}  
  
    \begin{mdframed}[style=mdmathdef] 
      \begin{definition}\label{mai:def002}
        Funkci \(F(x): J\rightarrow \realset\), kde \(J\subset \realset\) je interval, nazveme
        \textbf{primitivní} funkcí k funkci \(f(x)\) na intervalu \(J\) právě když, pro všechna
        \(x\in J\) je \(F'(x) = f(x)\). Nebo což je totéž, je-li \(f(x)\dd{x}\) pro každé \(x\in J\)
        diferenciálem funkce \(F(x)\),
        \begin{equation*}
          \dd{F}(x) = f(x)\dd{x}.
        \end{equation*}        
        V případě uzavřeného intervalu \(J=[a,b]\) požadujeme ještě, aby obě jednostranné derivace
        splňovaly \(F_+'(a)=f(a)\) a \(F_-'(b)=f(b)\). 
      \end{definition}
    \end{mdframed}

    Zřejmě, je-li \(F(x)\) primitivní funkcí k \(f(x)\) v intervalu \(a,b\) (kde může být popřípadě
    \(a=-\infty\), \(b=+\infty)\), je také primitivní funkcí k \(f(x)\) v každém intervalu \(\alpha,
    \beta\), tj. pro nejž platí \(a\leq\alpha<\beta\leq b\). 

    V dalším textu poznáme, že primitivní funkce mají velmi důležitou úlohu v matematice a v jejich
    aplikacích. Řešení mnoha úloh z integrálního počtu a příbuzných partií vede k určení primitvní
    funkce. Uvidíme například, že najdeme-li k funkci \(f(x)= x^2\) primitivní funkci \(F(x) =
    x^3\), vypočítáme velmi snadno obsah \(P\) obrazce, který je vyšrafován na obr.
    \ref{mai:fig099}.
    \begin{equation*}
      P = F(2) - F(0) = \frac{2^3}{3} = \frac{8}{3}.
    \end{equation*}
    Užitečnost získání primitivní funkce vysvitne zejména v kapitole \ref{mai:IchapVII}. Metodám
    hledání funkce je věnován následující text. Uvidíme, že určení primitivní funkce k dané
    elementární funkci je v obecnémpřípadě úloha podstatně obtíšžnější než určení derivace.  
    
    \begin{figure}[ht!]
      \centering
      \animategraphics[controls,autoplay,loop]{2}{mai_fig022}{}{}
      \caption{Graf primitivní funkce \(F(x) = x^3\)}
      \label{mai:fig099}
    \end{figure}

    Uvedeme nyní některé jednoduché příklady.
    %-------------------------------------
    \input{../src/MAI/exam/exam118.tex}
    %-------------------------------------

    Často používáme pro nezávisle proměnnou jiného oznčení než \(x\). Funkcí primitivní k funkci
    \(f(u)\) rozumíme pak ovšem funkci \(F(u)\), pro kterou Platí
    \begin{equation*}
      F'(u) = \diff{F}{u} = f(u),
    \end{equation*}
    a podobně při jiném označení. Například funkce \(F(u) = \tan u + 3\) je pro \(u\in(-\pi/2,
    \pi/2)\) primitivní funkcí k funkci \(f(u)=\frac{1}{\cos^2u}\), neboť pro každé \(u\in(-\pi/2,
    \pi/2)\) platí \(F'(u)=(\tan u + 3)' = \frac{1}{\cos^2u}\).

    Primitivní funkce k funkci \(f(x)=3x^2\), \(x\in(-\infty, \infty)\) je funkce \(F(x)=x^3\),
    neboť pro všechna \(x\) platí \((x^3)'=3x^2\). Avšak také funkce \(G(x) = x^3+5\) nebo funkce
    \(H(x)=x^3-2\pi\sqrt{3}\) a vůbec každá funkce \(R(x)=x^3+C\), kde \(C\) je libovolná (reálná)
    konstanta, je v intervalu \((-\infty, +\infty)\) primitivní funkcí k funkci \(f(x)=3x^2\), neboť
    \(G'(x)=H'(x)=R'(x)=3x^2\) pro každé \(x\in(-\infty, +\infty)\). 

    Z posledních příkladů je zřejmé, že známe-li (v uvažovaném intervalu) k dané funkci \(f(x)\)
    jednu primitivní funkci, známe jich nekonečně mnoho; je-li totiž \(F(x)\) jedna z nich, pak
    rovněž každá funkce tvaru \(F(x)+c\), kde \(c\) je libovolné reálné číslo, je primitivní funkcí
    k dané funkci \(f(x)\), neboť
    \begin{equation*}
      \bigl[F(x) + c\bigl] = F'(x) = f(x).
    \end{equation*}
    Vzniká nyní otázka: Najdeme-li k dané funkci \(f(x)\) primitivní funkci \(F(x)\), neexistují pak
    kromě funkcí tvaru \(F(x) + c\) ještě jiné primitivní funkce? Nebo jinak řečeno: Neexistují k
    dané funkci dvě různé primitvní funkce, lišící se jinak než o konstantu? Odpověď je záporná:
    Výrazem \(F(x) + c\) jsou vyčerpány všechny primitivní funkce k dané funkci \(f(x)\). Platí
    věta: 

    \begin{mdframed}[style=mdmathlemma] 
      \begin{lemma}\label{mai:lemma008}(Věta o rozdílu dvou primitivních funkcí) Je-li \(F(x)\) v
        intervalu \(J\) primitivní funkcí k funkci \(f(x)\), pak \textbf{každá} primitivní funkce k
        funkci \(f(x)\) v intervalu \(J\) je tvaru 
        \begin{equation*}
          F(x) + c,
        \end{equation*}
        kde \(c\) je (reálná) konstanta.
        \begin{proof}
          Tvrzení a) Nechť \(F(x)\) a \(G(x)\) jsou dvě libovolné primitivní funkce k funkci
          \(f(x)\) v intervalu \(J\). Máme dokázat, že se liší nejvýše o konstantu, tj. že platí 
          \begin{equation*}
            G(x) - F(x) = c,  \qquad x\in J. 
          \end{equation*}
          Podle definice primitivní funkce platí:
          \begin{equation*}
            F'(x) = f(x), \qquad G'(x) = f(x)
          \end{equation*}
          Funkce \(F(x)\) a \(G(x)\) mají tedy pro všechna \( x\in J\) stejná derivace, a tedy
          funkce
          \begin{equation*}
            R(x) = G(x) - F(x), \qquad x\in J.
          \end{equation*}
          má derivea rovnou nule. 
          \begin{equation*}
            R'(x) = G'(x) - F'(x) = f(x) - f(x) = 0
          \end{equation*}
          pro všechna \( x\in J\). Je-li však \(R'(x)=0\) pro všechna \(x\) z daného intervalu je
          \(R(x)=c\) v \(J\). Tedy \(R(x) = G(x) - F(x)=c\).
        \end{proof}
      \end{lemma}
    \end{mdframed}

    Geometrická interpretace věty \ref{mai:lemma008}: Grafy dvou libovolných primitivních funkcí k
    funkci \(f(x)\) (v uvažovaném intervalu \(J\)) lze ztotožnit posunutím ve směru osy \(y\) (obr.
    \ref{mai:fig100})

    \begin{figure}[ht!]
      \centering
      \includegraphics[height=5cm]{example-image-b} 
      \caption{Geometrická interpretace primitivní funkce \(F(x) +c\)}
      \label{mai:fig100}
    \end{figure}

    Všechny primitivní funkce k funkci \(f(x)\) se tedy liší navzájem jen o konstanu. Je-li známá
    jedna primitivní funkce \(F(x)\) k funkci \(f(x)\), lze všechny ostatnůí vyjádřit ve tvaru
    \(F(x) + c\), kde \(c\) je libovolné reálné číslo. Množina funkcí tvaru \(F(x) + c\) zahrnuje
    tedy všechny funkce, které mají derivaci \(f(x)\) (a tedy diferenciál \(f(x)\dd{x}\)). Pro tuto
    množinu funkcí, s níž se budeme v daším textu neustále setkávat, je vhodné zavést zvláštní
    název:  

    \begin{mdframed}[style=mdmathdef] 
      \begin{definition}\label{mai:def004}
        Množinu všech primitivních funkcí k funkci \(f(x)\) v intervalu \(J\) nazýváme
        \textbf{neručitým integrálem} k funkci \(f(x)\)  a označujeme ji \(\int f(x)\dd{x}\). Píšeme 
        \begin{equation*}
          \boxed{\int f(x)\dd{x} = F(x) + c \qquad x\in J}
        \end{equation*}
      \end{definition}
    \end{mdframed}

    Funkci \(f(x)\) nazveme \emph{integrandem}, symbol \(\int\) (který vznikl protažením písmena S)
    \emph{integračním znakem}. Výkon, kterým určujeme neurčitý integrál \(F(x) + c\) k dané
    primitivní funkci \(f(x)\), resp. k diferenciálu \(f(x)\dd{x}\), nazýváme \emph{integrováním}
    funkce \(f(x)\). Udůvodněný názvu integrál a jeho označení vysvitne později, až poznáme vztah
    mezi primitivní funkcí a tzv. určitým integrálem v kapitole \ref{mai:IchapVIII}. Slovem
    \uv{neurčitý} vyznačujeme, že uvažujeme všechny funkce tvaru \(F(x)+ c\), nikoli jednu
    primitivní funkci. Místo \[\int\dfrac{1}{x}\dd{x}\] je zvykem psát \[\int\dfrac{\dd{x}}{x}\]
    apod. 

    Ukázali jsme, že všechny primitivní funkce k dané funkci se mohou lišit navzájem až na
    konstatnu. Důležitá je taky otázka, kdy vůbec \emph{existuje} k dané funkci funkce primitivní.
    Postačující podmínku pro to dává věta 
    
    \begin{mdframed}[style=mdmathlemma] 
      \begin{lemma}\label{mai:lemma011}
        Ke každé funkci, spojité v otevřeném intervalu \(J\) existuje v tomto intervalu primitivní
        funkce. 
      \end{lemma}
    \end{mdframed}

    \subsection{Poznámky k definici}  
      Z definice \ref{mai:def002} vyplývá, že primitivní funkce je spojitou funkcí, neboť má
      derivaci a věta \ref{mai:lemma008} nám říká, že pokud k dané funkci existuje funkce
      primitivní, existuje jich nekonečně mnoho. Je-li např. \(F(x)\) primitivní funkce k funkci
      \(f(x)\) na intervalu \(J\), pak množina všech primitivních funkcí je množina \(\{F(x) + c;
      c\in\realset\}\). Tuto množinu označujeme symbolem \(\int f(x)\dd{x}\) a čteme \uv{integrál
      \(f(x)\dd{x})\)} Symbolu \(\int f(x)\dd{x}\) říkáme \textbf{neurčitý integrál}. Zpravidla
      píšeme
      \begin{mdframed}[style=mdeq]
        \begin{luaequ}\label{mai:eq102}
          \boxed{\int f(x)\dd{x} = F(x) + c}
        \end{luaequ}
      \end{mdframed}
      nebo jen \(\int f(x)\dd{x} = F(x)\) (tj. aditivní konstantu vynecháváme) a máme tím na mysli
      že \(F(x) \in \int f(x)\dd{x}\). Rovnost \ref{mai:eq102} je tedy rovnost mezi množinami,
      nikoliv rovnost funkcí. 
      
      V tomto smyslu tedy \(\int f(x)\dd{x}\) znamená, že \[\diff{}{x}\int f(x)\dd{x} = f(x)\], a
      teprve ve výsledku výpočtu připsat integrační konstantu \(c\), abychom vyznačili, že jde o
      množinu funkcí.

      Jedna z primitivní funkcí k funkci \(f(x)=x^3\), \(x\in(-\infty, +\infty)\) je \(F(x)=
      \frac{1}{4}x^4\). Je proto
      \begin{fleqn}[\parindent]
        \begin{equation*}
          \int x^3\dd{x} = \frac{x^4}{4} + c \qquad x\in(-\infty, +\infty)
        \end{equation*}
      \end{fleqn} 

      Jedna z funkcí, jejichž diferenciál je \(f(x) = \frac{1}{1+x^2}\dd{x}\), \(x\in(-\infty,
      +\infty)\) je \(F(x) = \arctan x\), neboť v tomto intervalu je \(\dd{(\arctan x)} =
      \frac{1}{1+x^2}\dd{x}\). Je proto
      \begin{fleqn}[\parindent]
        \begin{equation*}
          \int\frac{1}{1+x^2}\dd{x} = \arctan x + c \qquad x\in(-\infty, +\infty).
        \end{equation*}
      \end{fleqn}
      Často používáme pro argument jiného označení než \(x\).

      Nechť \(f(z) = \frac{1}{z+3}\), \(x\in(-3, +\infty)\). Pak jedna z primitivních funkcí je
      \(F(z) = \ln(z+3)\), a tedy
      \begin{fleqn}[\parindent]
        \begin{equation*}
          \int\frac{1}{z+3}\dd{x} = \ln(z+3) + c \qquad x\in(-3, +\infty).
        \end{equation*}
      \end{fleqn}
    
    \subsection{Některé vlastnosti integrálů}  
      Platnost několika následujících vztahů lze prověřit přímo užitím deﬁnic derivace a neurčitého
      integrálu. Tyto vztahy jsou při výpočtech často používány. Nejprve však uvedeme základní
      pravidla pro primitivní funkce, která plynou z pravidel pro derivování:
      \begin{subequations}
        \begin{flalign}
          \int\dd{f(x)}                    
            &= f(x) + c,                                  &\label{mai:eq134} \\
          \dxd\left[\int f(x)\dd{x}\right] 
            &= f(x)\dd{x},                                &\label{mai:eq135} \\
          \int[f(x)\pm g(x)]\dd{x}
            &= \int f(x)\dd{x} + \int g(x)\dd{x},         &\label{mai:eq103} \\
          \int kf(x)\dd{x}      
            &=k\int f(x)\dd{x},\,\text{\(k=\) konst.},    &\label{mai:eq104}\raisetag{14pt} \\
          \left[\int f(x)\dd{x}\right]'    
            &= f(x),                                      &\label{mai:eq136}
        \end{flalign}
      \end{subequations}
      
  \section{Základní integrály}\label{mai:IchapVIIsecII} 
    Neurčitý integrál k některým elementárním funkcím najdeme velmi snadno na základě známých
    výsledků z diferenciálního počtu.
    
    \begin{enumerate}
      \item Je-li \(n\neq-1\) a \(x\in(0,+\infty)\), platí \(\left(\dfrac{x^{n+1}}{n+1}\right)'=
            x^n\) proto
            % https://tex.stackexchange.com/questions/145657/align-equation-left
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int x^n\dd{x} = \dfrac{x^{n+1}}{n+1}, \hfill x\in(0,+\infty) 
              \end{equation*}
            \end{fleqn}  
            Pro některá \(n\) je možno platnost vztahu rozšířit. Například pro přirozená \(n\) platí
            vztah v celém intervalu \((-\infty,+\infty)\). Například: 
            \begin{flalign*}
              & \int x^6\dd{x}          
                =  \frac{1}{7}x^7 + c,                                 &                        \\
              & \int\frac{1}{x^4}\dd{x} 
                =   \int x^{-4}\dd{x} = -\frac{1}{3}x^{-3} + c 
                = - \frac{1}{3x^3} + c,                                &                        \\
              & \int\sqrt[3]{x^2}\dd{x} 
                =   \int x^{\frac{2}{3}}\dd{x} 
                =   \frac{3}{5}\sqrt[3]{x^5} + c,                      &                        \\
              & \int\frac{1}{\sqrt{t^7}}\dd{x} 
                =   \int t^{-\frac{7}{2}}\dd{x} 
                = - \frac{2}{5}\frac{1}{\sqrt{t^5}} + c,               & 
            \end{flalign*}
      \item Je-li \(F(x)=C\), kde \(C\) je konstanta, platí \(F'(x)=0\) pro všechna \(x\), a tedy
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int 0\cdot\dd{x} = c, \hfill x\in(-\infty,+\infty).
              \end{equation*}
            \end{fleqn}
      \item Je-li \(F(x)=x\), kde \(x\in(-\infty,+\infty)\), platí \(F'(x)=1\) pro všechna \(x\), a
            proto
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int 1\cdot\dd{x} = \int\dd{x} = x + c, \hfill x\in(-\infty,+\infty).
              \end{equation*}
            \end{fleqn}
            (speciální případ prvního integrálu pro \(n=1\)).
      \item Funkce \(F(x)=\ln x\), \(x\in(0,+\infty)\) má derivaci \(F'(x) = \frac{1}{x}\), a proto
            \begin{fleqn}[\parindent]  
              \begin{equation*}
                \int\frac{1}{x}\dd{x} = \ln x + c, \hfill x\in(0,+\infty).
              \end{equation*} 
            \end{fleqn}
            Funkce \(G(x) = \ln(-x)\), \(x\in(-\infty,0)\) má derivaci \(G'(x) = \frac{-1}{-x} =
            \frac{1}{x}\), a platí tedy
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int\frac{1}{x}\dd{x} = \ln(-x) + c, \hfill x\in(-\infty,0).
              \end{equation*}
            \end{fleqn}
            Oba vzorce můžeme spojit zápisem
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int\frac{1}{x}\dd{x} = \ln\abs{x} + c
              \end{equation*}
            \end{fleqn}
            pro \(x\) z intervalu \((-\infty,0)\) nebo pro \(x\) z intervalu \((0,+\infty)\).
            Protože také
            \begin{fleqn}[\parindent]
              \begin{equation*}
                (\ln kx)' = \frac{k}{kx} = \frac{1}{x} \hfill (kx>0),
              \end{equation*}
            \end{fleqn}  
            můžeme psát
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int\frac{1}{x}\dd{x} = \ln kx \hfill (kx>0).
              \end{equation*}
            \end{fleqn}  
            Přitom je tedy \(k\) libovolná kladná konstanta, uvažujeme-li \(x\) z intervalu
            \((0,+\infty)\), nebo libovolná záporná konstanta, uvažujeme-li \(x\) z intervalu
            \((-\infty,0)\) (aby bylo vždy \(kx>0\)). Integrační konstanta je již v tomto zápisu
            obsažena. Například pro kladná \(x\) je \(\ln kx = \ln k + \ln x = \ln x + c\).
            
            Podobně pro \(y=\ln\abs{x+a}\), \(x\neq-a\) dostaneme \(y'=1/(x+a)\), a proto
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int\frac{1}{x+a}\dd{x} = \ln\abs{x+a} + c
              \end{equation*}
            \end{fleqn} 
            v každém otevřeném intervalu, který neobsahuje bod \(x=-a\), resp. 
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int\frac{1}{x+a}\dd{x} = \ln k(x+a), \hfill k(x+a)>0.
              \end{equation*}
            \end{fleqn} 
      \item Derivace funkce \(y=\dfrac{1}{2a}\ln\abs{\dfrac{x-a}{x+a}}\), \(a\neq0\), \(x\neq a\),
            \(x\neq -a\) je
            \begin{fleqn}[\parindent]
              \begin{equation*}
                y'=\frac{1}{2a}\cdot\frac{x+a}{x-a}\cdot\frac{x+a-(x-a)}{(x+a)^2} 
                  = \frac{1}{x^2-a^2}.
              \end{equation*}
            \end{fleqn} 
            Tedy pro \(a\neq0\) je
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int\frac{1}{x^2-a^2}\dd{x} = \frac{1}{2a}\ln\abs{\dfrac{x-a}{x+a}} + c
              \end{equation*}
            \end{fleqn} 
            v každém otevřeném intervalu, kerý neobsahuje bod \(x\neq a\) nebo \(x\neq -a\), resp.
            \begin{fleqn}[\parindent] 
              \begin{equation*}
                \int\frac{1}{x^2-a^2}\dd{x} = \frac{1}{2a}\ln\abs{\dfrac{x-a}{x+a}} + c,
                \hfill \left(k\dfrac{x-a}{x+a}>0\right).
              \end{equation*}
            \end{fleqn} 
      \item Pro všechna reálná \(x\) platí
            \begin{fleqn}[\parindent]      
              \begin{equation*}
                (e^x)' = e^x, \,\, \left(\frac{1}{k}e^{kx}\right)' = e^{kx}, \,\,
                \left(a^x\frac{1}{\ln a}\right) = a^x
              \end{equation*}
            \end{fleqn} 
            kde \(a>0, a\neq1\). Proto je
            \begin{flalign*}
              & \int{e^x}\dd{x} = e^x +c, \quad \int{e^{kx}}\dd{x} = \frac{1}{k}e^{kx} + c      & \\
              & \int{a^x}\dd{x} =\frac{a^x}{\ln{a}} + c                                         & 
            \end{flalign*}
            kde \(a>0, a\neq1, x\in(-\infty,+\infty)\)
      \item Pro funkce \(F(x) = \sin x\), \(F(x) = -\cos x\) platí v celém intervalu
            \(x\in(-\infty,+\infty)\) \(F'(x)=\cos x\) a \(G'(x) = \sin x\). Odtud plyne
            \begin{flalign*}
              &\int\cos x\dd{x} =  \sin x + c, & \\
              &\int\sin x\dd{x} = -\cos x + c, &  
            \end{flalign*}           
            (Všimněme si rozdílu ve znaménkách při derivování a integrování funkcí \(\sin x\) a
            \(\cos x\).) 
      \item Pro funkci \(F(x) = \tan x\), \(x\neq\pm\frac{\pi}{2}, \pm\frac{3\pi}{2}, \ldots\),
            platí \(F'(x)=\frac{1}{cos^2x}\). Platí proto v každém otevřeném intervalu, který
            neobsahuje liché násobky čísla \(\frac{\pi}{2}\),
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int\dfrac{1}{\cos^2x}\dd{x} = \tan x + c.
              \end{equation*}
            \end{fleqn}
            Obdobně v každém otevřeném intervalu, který neobsahuje celé násobky čísla \(\pi\), platí
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int\dfrac{1}{\sin^2x}\dd{x} = -\cotg x + c.
              \end{equation*}
            \end{fleqn}
      \item Pro funkce \(F(x) = \arcsin x\), \(G(x) = -\arccos x\) platí v intervalu \((-1,1)\)
            \begin{fleqn}[\parindent]
              \begin{equation*}
                F'(x) = \dfrac{1}{\sqrt{1-x^2}}, \quad G'(x) = \dfrac{1}{\sqrt{1-x^2}},
              \end{equation*} 
            \end{fleqn}
            tedy
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \begin{rcases}
                  \int\dfrac{1}{\sqrt{1-x^2}}\dd{x} &=  \arcsin x + c \\
                  \int\dfrac{1}{\sqrt{1-x^2}}\dd{x} &= -\arccos x + k
                \end{rcases}x\in(-1,1).
              \end{equation*}
            \end{fleqn}
            Podle právě uvedených vzorců existují k funkci \(f(x)=1/\sqrt{1-x^2}\) dvě různé
            primitivní funkce. Výsledek však není ve sporu s větou \ref{mai:lemma008}, neboť platí
            \(\arcsin x - (-\arccos x) = \arcsin x + \arccos x = \frac{\pi}{2}\). Z této rovnice je
            zároveň vidět, že rozhodneme-li se v prvním vzorci pro určitou primitivní funkci tím, že
            zvolíme za \(c\) určité číslo, dostaneme z druhého vzorce touž funkci pro \(k = c
            +\frac{\pi}{2}\).
      \item Funkce
            \begin{fleqn}[\parindent]
              \begin{equation*}
                F(x) = \arcsin\frac{\pi}{2}\,\text{a}\, G(x) = \arcsin\frac{\pi}{2}\, a>0
              \end{equation*}
            \end{fleqn}  
            mají v intervalu \((-a,a)\) derivace
            \begin{flalign*}
              & F'(x) = \frac{1}{\sqrt{1-\frac{x^2}{a^2}}}\cdot\frac{1}{a}
                      = \dfrac{1}{\sqrt{a^2-x^2}},                           &               \\
              & G'(x) = \frac{1}{\sqrt{1-\frac{x^2}{a^2}}}\cdot\frac{1}{a}
                      = \dfrac{1}{\sqrt{a^2-x^2}}.                           &
            \end{flalign*}
            Proto je 
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \begin{rcases}
                  \int\dfrac{1}{\sqrt{a^2-x^2}}\dd{x} &=  \arcsin\frac{x}{a} + c \\
                  \int\dfrac{1}{\sqrt{a^2-x^2}}\dd{x} &= -\arccos\frac{x}{a} + k
                \end{rcases}
                \begin{array}{c}
                  a>0,      \\
                  x\in(-a,a).
                \end{array}
              \end{equation*}
            \end{fleqn} 
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int\dfrac{1}{\sqrt{16-x^2}} = \arcsin\dfrac{x}{4} + c \hfill x\in(-4,4).
              \end{equation*}
            \end{fleqn} 
      \item Derivace funkcí \(F(x) = \arctan x\) a \(G(x) = \arccotg x\), \(x\in(-\infty, \infty)\)
            jsou 
            \begin{fleqn}[\parindent]
              \begin{equation*}
                F'(x) = \dfrac{1}{1+x^2} \quad\text{a}\quad G'(x) = \dfrac{1}{1+x^2}
              \end{equation*}
            \end{fleqn} 
            proto
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \begin{rcases}
                  \int\dfrac{1}{1+x^2}\dd{x} &= \arctan x + c  \\
                  \int\dfrac{1}{1+x^2}\dd{x} &= \arccotg x + k
                \end{rcases}
                x\in(-\infty, \infty).
              \end{equation*}
            \end{fleqn} 
            Zde se také primitivní funkce \(\arctan x\), \(-\arccotg x\) liší jen o konstantu, neboť
            \(\arctan x - (-\arccotg x) = \frac{\pi}{2}\), ve shodě s větou
            \ref{mai:lemma008}. Derivování funkcí 
            \begin{fleqn}[\parindent]
              \begin{equation*}
                F(x) = \dfrac{1}{a}\arctan\dfrac{x}{a} \quad\text{a}\quad 
                G(x) = \dfrac{1}{a}\arccotg\dfrac{x}{a}
              \end{equation*}
            \end{fleqn} 
            dostaneme
            \begin{fleqn}[\parindent]
              \begin{equation*}
                F'(x) = G'(x) = \frac{1}{a}\cdot\dfrac{1}{1+\frac{x^2}{a^2}}\cdot\frac{1}{a} 
                      = \dfrac{1}{a^2+x^2}
              \end{equation*}
            \end{fleqn} 
            Proto
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \begin{rcases}
                  \int\dfrac{1}{a^2+x^2}\dd{x} &= \dfrac{1}{a}\arctan\dfrac{x}{a}  + c  \\
                  \int\dfrac{1}{a^2+x^2}\dd{x} &= \dfrac{1}{a}\arccotg\dfrac{x}{a} + k
                \end{rcases}
                x\in(-\infty, \infty).
              \end{equation*}
            \end{fleqn} 
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int\dfrac{1}{5+x^2}\dd{x} = \dfrac{1}{\sqrt{5}}\arctan\dfrac{x}{\sqrt{5}}  + c,
                \hfill x\in(-\infty, \infty)
              \end{equation*}
            \end{fleqn}
      \item Funkce \(F(x)=\ln k(x+\sqrt{x^2+a})\) má pro taková \(x, k, a\), pro která \(x^2+a>0\),
            \(k(x+\sqrt{x^2+a})>0\), derivaci
            \begin{fleqn}[\parindent]
              \begin{equation*}
                F'(x) = \dfrac{k\left(1+\dfrac{2x}{2\sqrt{x^2+a}}\right)}{k(x+\sqrt{x^2+a})}
                      = \dfrac{\dfrac{\sqrt{x^2+a}+x}{\sqrt{x^2+a}}}{x+\sqrt{x^2+a}}
              \end{equation*}
            \end{fleqn}
            Tedy
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int\dfrac{1}{\sqrt{x^2+a}}\dd{x} = \ln k(x+\sqrt{x^2+a}),
              \end{equation*}
            \end{fleqn}
            kde \(x^2+a>0\), \(k(x+\sqrt{x^2+a})>0\). Popřípadě podobně jako v bodě 4:
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int\dfrac{1}{\sqrt{x^2+a}}\dd{x} = \ln\abs{x+\sqrt{x^2+a}} + c,
              \end{equation*}
            \end{fleqn}
            v každém otevřeném intervalu, v němž je \(x^2+a>0\), \(k(x+\sqrt{x^2+a})\neq0\). Je-li
            \(a>0\), je pro všechna \(x\) (kladná, záporná i nulu) \(x^2+a>0\),
            \(x+\sqrt{x^2+a}>0\), a tedy
            \begin{fleqn}[\parindent]
              \begin{equation*}
                \int\dfrac{1}{\sqrt{x^2+a}}\dd{x} = \ln \bigl(x+\sqrt{x^2+a}\bigr) + c,
              \end{equation*}
            \end{fleqn}
            kde \(a>0\), \(x\in(-\infty, \infty)\). Znak absolutní hodnoty je zde zbytečný.
            Integrály, které jsme v tomto článku odvodili, se nazývají \emph{základní} a jsou
            přehledně sestaveny v následující tabulce.
    \end{enumerate}
  
    \subsection{Tabulka základních integrálů}\label{mai:IchapVIIsecIIssecI}
      Jak ale primitivní funkce hledat? V jednoduchých příkladech poslouží tabulka derivací, již
      čteme „zprava doleva“. (Je dobré si ji uložit do paměti.) Tabulka však pokryje jen velmi málo
      případů, pouze elementární funkce. Je tedy třeba najít metody, jak při hledání primitivních
      funkcí postupovat.

      Uveďme nyní některé základní integrály. Poznamenejme, že touto tabulkou nejsou zdaleka
      vyčerpány všechny funkce, ke kterým umíme primitivní funkce najít. Existují celé knihy
      obsahující tabulky integrálů a programy výrazně ulehčující hledání primitivních funkcí.
      Literatura: \cite{Rektorys1963}, \cite{Brabec1989}, \cite{diblik2002}. 

      Pokud není nic uvedeno, platí vzorce pro všechna \(x\) a pro všechny hodnoty uvedených
      konstant. Místo platí pro \(x\) z intervalu \((-\infty,0),(0,+\infty)\) píšeme stručně
      \(x\neq0\) apod. Obory platnosti uvádíme jen tam, kde nejsou evidentní.  

      \begin{flalign}
        \midrule
        & \int 0\dd{x} = c                                              \label{mai:eq105}&   \\
        & \int  \dd{x} = x + c                                          \label{mai:eq187}&   \\
        & \int a\dd{x} = ax + c                                         \label{mai:eq106}&   \\
        & \int x^n\dd{x} = \frac{x^{n+1}}{n+1}+c,                       \label{mai:eq107}&   \\              
          \shortintertext{\hspace{2em} kde \(
            \begin{cases}
              \forall x\in\realset,\,n\in\naturalset, n>0,         \\
              \forall x\in\realset-\{0\},\,n\in\naturalset, n<-1,  \\
              \forall x>0,\,n\in\realset\,\,n\neq-1
            \end{cases}\)
          }                                          
        & \int\frac{\dd{x}}{x} = 
            \ln\abs{x}+c \hspace{1ex}\forall x\neq0              &       \label{mai:eq108}   \\
        & \int\frac{\dd{x}}{x+a} = 
            \begin{cases}
               \ln\abs{x+a} + c,                             \\
               \text{pro } x\in(-a, +\infty)\cup(-\infty,+a) \\ 
              -\ln k(x+a),\, k(x+a)>0 
            \end{cases}                                  &\raisetag{14pt}\label{mai:eq181}   \\
        & \int\frac{\dd{x}}{x^2-a^2} = 
            \begin{cases}
               \dfrac{1}{2a}\ln\abs{\dfrac{x-a}{x+a}} + c,\, x\neq\pm a   \\[10pt]
               \dfrac{1}{2a}\ln k\dfrac{x-a}{x+a} + c,\, k\dfrac{x-a}{x+a} >0 
            \end{cases}                                  &\raisetag{14pt}\label{mai:eq182}   \\
        & \int e^x \dd{x}       = e^x+c, \,\,
          \int e^{kx} \dd{x}    = \frac{1}{k}e^{kx}+c            &       \label{mai:eq109}   \\
        & \int\ln x\dd{x}       = 
            x\ln x - x + c \hspace{1ex}\forall x>0               &       \label{mai:eq110}   \\
        & \int a^x \dd{x}     =
          \frac{a^x}{\ln a}+c 
          \hspace{1ex}\forall a>0,\,a\neq1                       &       \label{mai:eq111}   \\
        & \int \sin x \dd{x}  = -\cos x + c                      &       \label{mai:eq112}   \\
        & \int \cos x \dd{x}  =  \sin x + c                      &       \label{mai:eq113}   \\
        & \int\frac{\dd{x}}{\cos^2x} =  \tan x + c               &       \label{mai:eq114}   \\
          \shortintertext{\hspace{2em}\(\forall x\neq\frac{1}{2}\pi+k\pi,\,k\in\naturalset\)}       
        & \int\frac{\dd{x}}{\sin^2x} =  -\cotg x+c               &       \label{mai:eq115}   \\
          \shortintertext{\hspace{2em}\(\forall x\neq k\pi,\,k\in\naturalset\)}
        & \int\frac{\dd{x}}{\sqrt{1-x^2}} =
            \begin{cases}
              +\arcsin x + c,        \\
              -\arccos x + c 
            \end{cases}                                           &       \label{mai:eq116}  \\
          \shortintertext{\hspace{2em}\(\forall x\in(-1,1) \)}  
        & \int\frac{\dd{x}}{\sqrt{a^2-x^2}} =
          \begin{cases}
            +\arcsin\dfrac{x}{a} + c,         \\[10pt]
            -\arccos\dfrac{x}{a} + c 
          \end{cases}                                             &       \label{mai:eq179}  \\
        \shortintertext{\hspace{2em}\(\forall a>0, x\in(-a,a) \)}  
        & \int\sinh x\dd{x} = \cosh x + c                         &       \label{mai:eq117}  \\
        & \int\dfrac{\dd{x}}{\sinh^2 x} = -\cotgh x + c\, x\neq0  &       \label{mai:eq118}  \\
        & \int\cosh x\dd{x} = \sinh x + c                         &       \label{mai:eq119}  \\
        & \int\dfrac{\dd{x}}{\cosh^2 x} = \tanh x + c             &       \label{mai:eq120}  \\
        & \int\frac{\dd{x}}{1+x^2} =              
        \begin{cases}
           \arctan x + c,           \\
          -\arccotg x + c 
        \end{cases}                                               &       \label{mai:eq121}  \\
        & \int\frac{\dd{x}}{1-x^2} =              
        \begin{cases}
           \argtanh x + c,                        \, &\abs{x}<1          \\
           \arccotg x + c                         \, &\abs{x}>1          \\
           \dfrac{1}{2}\ln\abs{\dfrac{1+x}{1-x}}  \, &\abs{x}\neq1        
        \end{cases}                                               &       \label{mai:eq122}  \\
        & \int\frac{\dd{x}}{a^2+x^2} =              
        \begin{cases}
           \dfrac{1}{a}\arctan\dfrac{x}{a}  + c,  \, a\neq0 \\[10pt]
          -\dfrac{1}{a}\arccotg\dfrac{x}{a} + c 
        \end{cases}                                               &       \label{mai:eq180}  \\
        & \int\frac{\dd{x}}{\sqrt{x^2 + 1}} =
            \begin{cases}
                \ln(x + \sqrt{x^2+1}) + c,         \\
                \argsinh x            + c 
            \end{cases}                                           &       \label{mai:eq192}  \\ 
        & \int \frac{\dd{x}}{\sqrt{x^2 - 1}} =
            \begin{cases}
                \ln(x + \sqrt{x^2-1}) + c,\, &\abs{x}>1  \\
                \argcosh x            + c \, &x>1  
            \end{cases}                                           &       \label{mai:eq123}  \\    
        & \int\frac{\dd{x}}{\sqrt{x^2+a^2}} 
            = \begin{cases}
                  \argsinh\dfrac{x}{a}   + c  \\[10pt]
                  \ln(x+\sqrt{x^2+a^2}) + c     
              \end{cases}                                          &      \label{mai:eq124}  \\
        & \int \frac{\dd{x}}{\sqrt{x^2-a^2}} 
            = \begin{cases}
                  \argcosh\dfrac{x}{a}   + c   \\[10pt]
                  \ln(x+\sqrt{x^2-a^2}) + c
              \end{cases}                                          &      \label{mai:eq125}  \\
        & \int\tan x \dd{x}   = \ln\abs{\sec x} + c                &      \label{mai:eq126}  \\
        & \int\sec x \dd{x}   = \ln\abs{\sec x + \tan x} + c       &      \label{mai:eq127}  \\
        & \int\sec^2 x \dd{x} = \tan x + c                         &      \label{mai:eq128}  \\
        & \int\sec x\tan x \dd{x} = \sec x + c                     &      \label{mai:eq129}  \\
        & \int\frac{a}{a^2+x^2}\dd{x} = \tan^{-1}\frac{x}{a} + c   &      \label{mai:eq130}  \\
        & \int\frac{a}{a^2-x^2}\dd{x} = 
          \frac{1}{2}\ln\left\lvert\frac{x+a}{x-a}\right\rvert     &      \label{mai:eq131}  \\
        & \int\frac{\dd{x}}{\sqrt{a^2-x^2}} = 
          \sin^{-1} \frac{x}{a}                                    &      \label{mai:eq132}  \\
        & \int\frac{a}{x\sqrt{x^2-a^2}}\dd{x} = 
          \sec^{-1} \frac{x}{a}                                    &      \label{mai:eq133}     
      \end{flalign}
    
      \begin{mdframed}[style=mdnote]
        \begin{note}  
          \(\argsinh x\), \(\argcosh x\), \(\argtanh x\), \(\argcoth x\) jsou funkce inverzní k
          hyperbolickým funkcím. Značení těchto funkcí není jednotné. Správné zkratky jsou ty, které
          specifikuje norma \texttt{ISO 80000-2}. Skládají se z \uv{ar} následovaných zkratkou
          odpovídající hyperbolické funkce (např. arsinh, arcosh).

          Nicméně, předpona \uv{arc} - následovaná odpovídající hyperbolickou funkcí (např. arcsinh,
          arccosh) je také běžně vidět, analogicky s nomenklaturou pro inverzní trigonometrické
          funkce. Není to však správné pojmenování, protože prefix \uv{arc} je zkratka pro
          \textbf{arcus}, zatímco prefix \uv{ar} znamená \textbf{area}. 

          Autoři jako prof. K. Rektorys upřednostňují použití označení \(\argsinh\), \(\argcosh\),
          \(\argtanh\) atd., kde předpona \uv{arg} je zkratkou latinského \textbf{argumentu}. V
          počítačové vědě se to často zkracuje na asinh.

          Používá se také zápis \(\sinh^{-1}(x)\), \(\cosh^{-1}(x)\) atd., a to navzdory
          skutečnosti, že je třeba dbát na to, aby nedošlo k nesprávným interpretacím horního indexu
          \(-1\) jako mocniny, na rozdíl od zkratky pro označení inverzní funkce
          (např. \(\cosh^{-1}(x)\) versus \(\cosh(x)^{-1}\)).
        \end{note}
      \end{mdframed}

    \subsection{Elementárnost primitivních funkcí}\label{mai:IchapVIIsecIIssecII} 
      Třebaže ke každé spojité funkci existuje primitivní funkce, nelze v mnoha případech tuto
      primitivní funkci vyjádřit pomocí elementárních funkcí. Jinými slovy, nedovedeme použitím
      uvedených tří metod (metody integrování úpravou a rozkladem, metody integrování per partes a
      metody substituční) vypočítat daný integrál v tom smyslu, že jej převedeme na jeden nebo více
      tabulkových integrálů, čímž je zároveň zaručeno, že také primitivní funkce je elementární
      funkcí. Příkladem takové funkce je funkce
      \(e^{x^2}\). Integrálem
      \begin{equation*}
        \int e^{x^2}\dd{x}
      \end{equation*}
      je tedy definována nová transendentní funkce. Podobně jsou nové transendentní funkce
      definovány integrály
      \begin{align*}
        \text{Si }x 
          &= \int\limits_0^x     \frac{\sin t}{t}\dd{t},&&\ldots\,\text{integrálsinus}       \\
        \text{Ci }x 
          &=-\int\limits_x^\infty\frac{\cos t}{t}\dd{t},&&\ldots\,\text{integrálcosinus}     \\
        \text{Li }x 
          &= \int\limits_0^x     \frac{\dd{t}}{\ln t},  &&\ldots\,\text{logaritmusintegrál}  \\
        \text{Ei }x 
          &= \int\limits_{-\infty}^x \frac{e^t}{t}\dd{t}&&   
      \end{align*}

      V některých případech může být příčinou nezdaru nevhodnost použitého početního postupu. 

  \section{Metody určení primitivní funkce}\label{mai:IchapVIIsecIII}
    Procesu hledání primitivní funkce se často říká integrování nebo integrace (od slova“integrál”),
    což z matematického hlediska znamená provést inverzní operaci k operaci derivování. Smutnou
    zprávou je, že na rozdíl od derivování neexistuje obecný vzorec pro integrování součinu či
    podílu, ani obecný vzorec pro integrování složených funkcí. Při hledání integrálů složitějších
    funkcí se využívá např. \emph{linearita, metoda per partes, substituční metoda}, popř. některé
    další speciální metody. Řešitel v mnoha případech musí projevit důvtip a intuici, která mu
    pomůže nalézt primitivní funkci k dané funkci.

    % --------------------------Integrování součtu, úprava integrandu-------------------------------
    \subsection{Integrování součtu, úprava integrandu}\label{mai:IchapVIIsecIIIssecI}  
      V tomto článku ukážeme metody, jež nám umožní najít neurčitý integrál některých funkcí
      jednoduchého tvaru, jež nejsou uvedeny v tabulce základních integrálů. Příslušné věty jsou
      důsledkem známých vět z diferenciálního počtu o derivování součtu a součinu funkcí a o
      derivování složené funkce. 

      \begin{mdframed}[style=mdmathlemma]
        \begin{lemma}\label{mai:lemma012}        
          Existují-li k funkcím
          \begin{equation}\label{mai:eq183}
            f_1(x), f_2(x), \ldots f_n(x) 
          \end{equation}
          v otevřeném intervalu \(J\) primitivní funkce
          \begin{equation}\label{mai:eq184}
            F_1(x), F_2(x), \ldots F_n(x) 
          \end{equation}
          pak funkce 
          \begin{equation}\label{mai:eq185}
            F(x) = c_1F_1(x) + c_2F_2(x) + \ldots + c_nF_n(x),
          \end{equation}
          kde \(c_1, c_2, \ldots, c_n\) jsou libovolné (reálné) konstanty, je v intervalu \(J\)
          primitivní funkci k funkci 
          \begin{equation}\label{mai:eq186}
            f(x) = c_1f_1(x) + c_2f_2(x) + \ldots + c_nf_n(x),
          \end{equation}
        \end{lemma}
        \begin{proof}
          Protože podle předpokladu \(F'_1(x) = f_1(x)\), \(F'_2(x) = f_2(x),\ldots, F'_n(x) =
          f_n(x)\), je funkce \eqref{mai:eq186} v \(J\) derivací funkce \eqref{mai:eq185}.
        \end{proof}
      \end{mdframed}

      Věta \eqref{mai:lemma012} se vyslovuje obvykle v tomto tvaru, který je pro účely integrálního
      počtu vhodnější:
      \begin{mdframed}[style=mdmathlemma]
        \begin{lemma}\label{mai:lemma013}        
          Existují-li v otevřeném intervalu \(J\) neurčité integrály funkcí
          \begin{equation}\label{mai:eq191}
            f_1(x), f_2(x), \ldots f_n(x) 
          \end{equation}
          a jsou-li \(c_1, c_2, \ldots, c_n\) libovolné konstanty, existuje  neurčitý integrál
          funkce  
          \begin{equation}\label{mai:eq188}
            f(x) = c_1f_1(x) + c_2f_2(x) + \ldots + c_nf_n(x),
          \end{equation}
          a platí
          \begin{equation}\label{mai:eq189}
            \begin{multlined}
              \int[c_1f_1(x) + c_2f_2(x) + \ldots + c_nf_n(x)]\dd{x}  =    \\   
              \int{c_1f_1(x)}\dd{x} + \int{c_2f_2(x)}\dd{x} + \ldots + \int{c_nf_n(x)}\dd{x}.
            \end{multlined}
          \end{equation}
        \end{lemma}
      \end{mdframed}
      Přitom rovnici \eqref{mai:eq189} rozumíme takto: Na její pravé straně jsou součty funkcí tvaru
      \begin{equation*}
        c_1[F_1(x) + C_1], c_2[F_2(x) + C_2], \ldots, c_n[F_n(x) + C_n]
      \end{equation*}
      na její levé straně je funkce tvaru \(F(x)+C\), kde \(F(x)\) je dána rovnicí
      \eqref{mai:eq186}. Zvolíme-li konstanty \(C_1, C_2, \ldots C_n\) libovolně, pak v obecném
      případě rovnice 
      \begin{equation}\label{mai:eq190}
        F(x) + c = c_1[F_1(x) + C_1] + c_2[F_2(x) + C_2] + \ldots + c_n[F_n(x) + C_n]
      \end{equation}     
      neplatí. Zvolíme-li \(C_1, C_2, \ldots C_n\) libovolně, lze konstantu \(c\) určit tak, aby
      \eqref{mai:eq190} bylo splněno v celém intervalu \(J\), a naopak, zvolíme-li \(c\) libovolně,
      je možno konstanty \(C_1, C_2, \ldots C_n\) zvolit tak, aby byl splněn vztah
      \eqref{mai:eq190}. 

      V tomto smyslu je tedy třeba rozumět rovnici \eqref{mai:eq189}. S rovnicemi tohoto typu se v
      textu ještě často setkáme. Uveďme nyní několik příkladů na použití věty \eqref{mai:lemma013}:
      %-------------------------------------
      \input{../src/MAI/exam/exam142.tex}
      %-------------------------------------
      %-------------------------------------
      \input{../src/MAI/exam/exam143.tex}
      %------------------------------------- 
      %-------------------------------------
      \input{../src/MAI/exam/exam144.tex}
      %-------------------------------------
      %-------------------------------------
      \input{../src/MAI/exam/exam145.tex}
      %-------------------------------------
    % --------------------------Integrace po částech - per partes-----------------------------------
    \subsection{Integrace po částech - per partes}\label{mai:IchapVIIsecIIIssecII}
      Metoda integrace \emph{per partes} neboli \emph{po částech} využívá vzorce pro derivaci 
      součinu funkcí. Připomeňme si jej: Pro derivaci součinu dvou funkcí \(u(x)\) a \(u(x)\) platí
      \cite[p.~137]{Musilova2009MA1}.
      \begin{equation}\label{mai:eq101}
        [u(x)v(x)]' = u(x)'v(x) + u(x)v'(x).
      \end{equation} 
      Primitivní funkcí levé strany je \(F(x) = u(x)v(x)\), a tedy
      \begin{equation*}
        u(x)v(x) =  \int u'(x)v(x)\dd{x} + \int u(x)v'(x)\dd{x}
      \end{equation*}  
      za předpokladu, že existují obě primitivní funkce na pravé straně. K čemu může tento
      samozřejmý vzorec sloužit při hledání primitivní funkce? Dejme tomu, že zadaná funkce
      \(f(x)\), k níž máme hledat funkci primitivní, je tvaru \(f(x) = u'(x)v(x)\), a my si s ní
      nevíme rady. Je však možné, že bychom si docela dobře poradili s primitivní funkcí k funkci
      \(g(x) = u(x)v(x)\). A předchozí vzorec umožňuje nahradit výpočet neurčitého integrálu z
      funkce \(f(x)\) výpočtem neurčitého integrálu z funkce \(g(x)\), tedy

      \begin{equation}\label{ma:eq_perpartes}
        \int u'(x)v(x)\dd{x} = u(x)v(x) - \int u(x)v'(x)\dd{x} 
      \end{equation}

      %-------------------------------------
      \input{../src/MAI/exam/exam111.tex}
      %-------------------------------------

      Není vždy jednoduché rozpoznat, jak máme rozložit funkci \(f(x)\) na součin funkcí \(u'(x)\) 
      a \(v(x)\). Takový rozklad není určen jednoznačně a požadavek na něj bychom mohli (dosti 
      nepřesně) formulovat tak, aby funkce \(v'(x)\) byla jednodušší než v \(v(x)\) (například 
      derivováním polynomu se snižuje jeho stupeň) a funkce \(u'(x)\) a \(u(x)\) aby byly zhruba 
      „stejně složité“ (například \(u'(x) =e^x\), \(u(x) = e^x\), nebo \(u'(x) = \cos x\), \(u(x) = 
      \sin x\), apod.). Spolehlivě používat metodu per partes se však můžeme naučit pouze studiem 
      vyřešených příkladů z literatury a praktickým procvičováním \cite[p.~138]{Musilova2009MA1}.
  
      %-------------------------------------
      \input{../src/MAI/exam/exam109.tex}
      %-------------------------------------
  
    %--------------------------- Substituční metoda ----------------------------------------------
    \subsection{Substituční metoda typu \(\varphi(x) = t\)}\label{mai:IchapVIIsecIIIssecIII}
      Tato metoda \emph{substituce} neboli \emph{náhrady} spočívá v tom, že vhodně zvolenou funkci
      obsaženou v předpisu \(f(x)\) označíme jako novou jednoduchou proměnnou. Čeho tím dosáhneme?
      Předpokládejme například, že \[f(x)=\varphi'(x)g[\varphi(x)]\] a označme jako novou proměnnou
      \(u = f(x)\). Že to vypadá, jako bychom se chystali použít vzorec pro derivaci složené funkce?
      Správně! Dejme tomu, že známe primitivní funkci \(G(u)\) k funkci \(g(u)\). Pak platí
      \begin{equation*}
        \left[G\left(\varphi(x)\right)\right]' = G'\left[\varphi(x)\right]\cdot\varphi'(x) 
        = g\left[\varphi(x)\right]\cdot\varphi'(x),     
      \end{equation*}
      a tedy
      \begin{equation*}
        \int \varphi'(x) g\left[\varphi(x)\right]\dd{x} =  G\left[\varphi(x)\right]. 
      \end{equation*}      
      Na základě těchto úvah formulujeme následující větu (viz. \cite[p.~142]{diblik2002}):
      \begin{mdframed}[style=mdmathlemma]
        \begin{lemma}\label{mai:lemma009}          
          (\textbf{o substituci}). Nechť funkce \(F(t)\) je primitivní funkcí k funkci \(f(t)\) v
          intervalu \(\alpha, \beta\). Nechť funkce \(t = \varphi(x)\) v intervalu \((a,b)\).
          [Intervaly \(\alpha, \beta\) a \((a,b)\) mohou být popřípadě nekonečné.] Pro každé
          \(x\in(a,b)\) nechť číslo \(\varphi(x)\) patří do intervalu \(\alpha, \beta\). Pak v
          intervalu \((a,b)\) je funkce \(F(\varphi(x))\) primitivní funkcí k funkci
          \(f(\varphi(x))\varphi'(x)\), tj. 
          \begin{fleqn}[0pt]
            \begin{equation}\label{mai:eq176}
              \int{f(\varphi(x))\varphi'(x)\dd{x}} = F(\varphi(x)) + c.
            \end{equation}
          \end{fleqn}
          Tento výsledek je zvykem zapisovat v integrálním počtu takto:
          \begin{fleqn}[0pt]
            \begin{equation}\label{mai:eq177}
              \int{f[\varphi(x)]\varphi'(x)\dd{x}}= \int f(t)\dd{t}= F(t)+c
              \raisetag{14pt}
            \end{equation}
          \end{fleqn}
          kde \(t=\varphi(x)\).
        \end{lemma}
      \end{mdframed}
  
      Základem úspěchu při aplikací věty je správný výběr funkce $\varphi(x)$. Praxe je totiž
      taková, že výpočet konkrétních příkladů je schématicky veden od rov. \eqref{mai:eq177} ke
      vzorci rov. \eqref{mai:eq176}.

      Vzorec \ref{mai:eq177} se sandno pamatuje. Dosadíme-li v integrálu \(\int f(t)\dd{t}\)
      formálně \(t=\varphi(x)\) a (diferencování tohoto vztahu) \(\dd{t} = \varphi'(x)\), dostaneme
      integrál \(\int{f[\varphi(x)]\varphi'(x)\dd{x}}\).

      %-------------------------------------
      \input{../src/MAI/exam/exam110.tex}
      %-------------------------------------

      %-------------------------------------
      \input{../src/MAI/exam/exam124.tex}
      %-------------------------------------

      %-------------------------------------
      \input{../src/MAI/exam/exam125.tex}
      %-------------------------------------      

      %-------------------------------------
      \input{../src/MAI/exam/exam126.tex}
      %------------------------------------- 

      %-------------------------------------
      \input{../src/MAI/exam/exam119.tex}
      %-------------------------------------

      Ukažme, že platí 
      \begin{equation}\label{mai:eq139}
        \boxed{\int{\dfrac{f'(x)}{f(x)}}\dd{x} = \ln\abs{f(x)} + c.}
      \end{equation}
      Zavedeme substituci \(f(x) =t\), pak \(f'(x)\dd{x} = \dd{t}\) a 
      \begin{equation*}
        \int{\dfrac{\dd{t}}{t}} = \ln\abs{t} + c = \ln\abs{f(x)} + c
      \end{equation*}
      na každém intervalu, v němž \(f(x)\neq 0\) a existuje \(f'\). Připomeňme, že výraz
      \(\dfrac{f'(x)}{f(x)}\) se nazývá \emph{logaritmická derivace funkce} \(f\). Viz příklad
      \ref{mai:eq141}.
   

    % -------------------Substituční metoda II------------------------------------------------------
    \newpage
    \subsection{Substituční metoda II}
      Druhý typ substituční metody spočívá naopak v tom, že na místo původní proměnné \(x\) 
      dosadíme vhodnou funkci \(x = \psi(t)\). Místo primitivní funkce k funkci \(f(x)\) pak 
      hledáme primitivní funkci k funkci \(g(t) = f[\psi(t)]\psi'(t)\). Skutečně, je-li \(F(x)\) 
      primitivní funkcí k \(f(x)\), pak derivací složené funkce \(G(t) = F[\psi(t)]\) dostaneme
      \begin{equation*}
       G'(t) = F'[\psi(t)]\psi'(t) = f[\psi(t)]\psi'(t) = g(t).
      \end{equation*}

      %-------------------------------------
      \input{../src/MAI/exam/exam122.tex}
      %-------------------------------------

      Jistě nám neuniklo, že princip substitučních metod I a II je stejný. Jsou totiž obě založeny 
      na použití pravidla pro derivaci složené funkce.
       
    %--------------------------- Integrace racionální funkce--------------------------------------
    \newpage
    \subsection{Integrace racionální funkce}
      Jde o integrály 
      \begin{equation}\label{mai:eq157}
        \int\dfrac{P(x)}{Q(x)}\dd{x}
      \end{equation}
      kde \(P(x)\) a \(Q(x)\) jsou mnohočleny (budeme všude předpokládat, že \(P(x)\) a \(Q(x)\)
      mají \emph{reálné koeficienty}). Základní myšlenka: Funkci za znakem integrálu rozložíme v
      součet jednoduchých funkcí, které dovedeme integrovat:
      
      Je-li stupeň \(m\) mnohočlenu \(P(x)\) větší nebo roven stupni \(n\) mnohočlenu \(Q(x)\), pak
      dělením převedeme výraz \(P(x):Q(x)\) na součet mnohočlenu (stupně \(m-n\)) a \textbf{ryze}
      lomené funkce
      \begin{equation}\label{mai:eq158}
        \dfrac{R(x)}{Q(x)},
      \end{equation}
      kde stupeň \(r\) mnohočlenu \(R(x)\) je menší než stupeň \(n\) mnohočlenu \(Q(x)\).
      Mechanismus dělení:
      \begin{equation*}
        \rotatebox{90}{$
          {\polylongdiv[style=C,div=:]{x^3+4x^2-x+2}{x^2+x-3}}
        $}
      \end{equation*}

      \begin{mdframed}[style=mdmathlemma] 
        \begin{lemma}\label{mai:lemma010}
          Každý mnohočlen
          \begin{equation*}
            Q(x) = a_nx^n + a_{n-1}x^{n-1} + \cdots + a_1x + a_0
          \end{equation*}
          s reálnými koeficienty lze (až na pořadí faktorů jednoznačně) rozložit takto (srov.
          příklad \ref{MAI:exam135}):
          \begin{equation}\label{mai:eq159}
            Q(x) = a_n(x-\alpha_1)^{k_1}(x-\alpha_2)^{k_2}\ldots                   \notag \\
            \ldots(x-\alpha_i)^{k_i}(x^2+p_1x+q_1)^{l_1}(x^2+p_2x+q_2)^{l_2}\ldots \notag \\ 
            \ldots(x^2+p_jx+q_j)^{l_j}.
          \end{equation}
          Přitom čísla \(\alpha_1, \alpha_2, \ldots \alpha_i\), \(p_1, q_1, p_2, q_2, \ldots \) jsou
          reálná a kvadratické výrazy v \ref{mai:eq157} nejsou rozložitelné v reálné lineární
          činitele - mají tedy záporný diskriminant tj. platí
          \begin{equation}\label{mai:eq160}
            \frac{p^2}{4}-q<0.
          \end{equation} 
        \end{lemma}
      \end{mdframed}

      Tvar rozkladu \ref{mai:eq160} vznikne ze známého rozkladu polynomu \(Q(x)\) v součin
      kořenových činitelů takto: Pokud \(\alpha\) je reálný kořen, zůstává činitel \(x-\alpha\) v
      rozkladu nezměněn. Je-li \(\beta\) komplexní kořen \(\beta = \beta_1-\imath\beta_2\), pak má
      \(Q(x)\) také komplexně sdružený kořen \(\bar{\beta} = \beta_1-\imath\beta_2\). Součin
      příslušných kořenových činitelů
      \begin{equation}\label{mai:eq161}
        \left[x-(\beta_1+\imath\beta_2)\right]  
        \left[x-(\beta_1-\imath\beta_2)\right]                                     \notag \\
        = (x-\beta_1)^2+\beta^2_2 = x^2-2\beta_1x + \beta^2_1+\beta^2_2. 
      \end{equation}
      dává kvadratický výraz s reálnými koeficienty. Je-li \(l\) násobnost kořene \(\beta\), pak
      touž násobnost má i kořen \(\bar{\beta}\) a v (\ref{mai:eq159}) dostaneme výraz tvaru
      \begin{equation*}
        (x^2+px+q)^l.
      \end{equation*}

      Uvedené příklady byly jednoduché, polynomy nízkého stupně a vzláštního tvaru, takže rozklad
      jsme mohli provést jednoduchými úpravami. Často se podaří zjistit kořen \(\alpha\) daného
      mnohočlenu zkusmo, zejména má-li tento mnohočlen celočíselné koeficienty. V aplikacích se však
      vyskytují mnohem složitější případy. Otázky nalézt kořeny polynomu a řešit soustavy lineárních
      rovnic v obecném případě patří do speciálních partií algebry a matematické analýzy, zejména
      numerických metod.
      
      Například funkci \(\frac{1}{x^2-4}\) integrujeme takto: Zřejmě v každém intervalu, který
      neobsahuje body \(x=2\), \(x=-2\), platí
      \begin{equation*}
        \dfrac{1}{x^2-4} = \dfrac{1}{4}\left(\dfrac{1}{x-2} - \dfrac{1}{x+2}\right)
      \end{equation*}
      takže v každém takovém intervalu jedině
      \begin{align*}
        \int\dfrac{1}{x^2-4}\dd{x}  
          &= \dfrac{1}{4}\int\left(\dfrac{1}{x-2} - \dfrac{1}{x+2}\right)\dd{x}             \\
          &= \dfrac{1}{4}\left(\ln\abs{x-2} - \ln\abs{x+2}\right) + c.        
      \end{align*}

      V tomto jednoduchém případě jsme našli rozklad velmi snadno. Je otázka, lze-li vždy racionální
      funkci rozložit na takové jednoduché funkce, které dovedeme integrovat. V této kapitole
      uvidíme, že odpověď je kladná a že nakonec půjde vždy jen o integrování mnohočlenů a o
      integrování několika typů racionálních funkcí (tzv. \emph{parciálních zlomků}). 

      %-------------------------------------
      \input{../src/MAI/exam/exam135.tex}
      %-------------------------------------
      
    %--------------------------- Integrace ryze lomené racionální funkce----------------------------
    \newpage
    \twocolumn[\subsection{Integrace ryze lomené racionální funkce rozkladem na parciální zlomky}]
      Některé příklady v předchozím odstavci, (viz např. \ref{MAI:exam135}) jsme dělením čitatele
      integrandu jmenovatelem dostali rozklad integrandu na součet racionální funkce (polynomu) a
      ryze lomené racionální funkce. Integrování polynomu je snadné, neboť jde o součet integrálů
      tvaru $\int c_kx^k dx$, kde $k$ je celé nezáporné číslo. Omezíme se tedy na integrování
      \emph{ryze lomené racionální funkce},  tj. funkce ve tvaru $P(x)/Q(x)$, kde $P(x), Q(x)$ jsou
      polynomy, přičemž stupeň polynomu $P(x)$ je menší než stupeň polynomu $Q(x)$. Taková funkce
      může vzniknout součtem několika jednoduchých zlomků (viz. následující příklad
      \ref{MAI:exam116}).
      
      %-------------------------------------
      \input{../src/MAI/exam/exam116.tex}
      %-------------------------------------
      
      Jsme tedy vedeni myšlenkou, zda naopak každá ryze lomená racionální funkce se dá rozložit
      na součet jednoduchých zlomků určitého tvaru - budeme jim říkat \textbf{parciální zlomky},
      které umíme integrovat. Tím se budeme zabývat v dalších odstavcích. 
    
      %-------------------------------------
      \input{../src/MAI/exam/exam120.tex}
      %-------------------------------------
      
      \begin{mdframed}[style=mdmathdef] 
        \begin{definition}\label{mai:def003}
          Parciální (částečným) zlomkem, budeme nazývat zlomek tvaru
          \begin{equation}\label{mai:eq168}
            \frac{A}{(x-\alpha)^k} \qquad\text{nebo}\qquad\frac{Bx + D}{(x^2 + px + q)^k}
          \end{equation}  
          kde \(A,\ B,\ D,\ \alpha,\ p,\ q\) jsou reálné konstanty, trojčlen \(x^2 + px + q\) nemá
          reálné kořeny (tj. má záporný diskriminant $p^2-4q < 0$), $k$ celé nezáporné číslo.          
        \end{definition}
      \end{mdframed}    
      
      Jak ukazuje definice \ref{mai:def003}, jsou to funkce těchto čtyř typů:
      \begin{equation}\label{mai:eq166}
        \boxed{f_1(x) = \dfrac{A}{x -\alpha}.} \hfill k = 1
      \end{equation}
      Ten již dovedeme snadno integrovat
      \begin{equation*}
        \int\dfrac{A}{x -\alpha} = A\ln\abs{x-\alpha} + c, 
      \end{equation*}
      
      Druhý typ zlomku dostáváme pro případ \( k>1\)
      \begin{equation}\label{mai:eq167}
        \boxed{f_2(x) = \dfrac{A}{(x -\alpha)^k}.} \hfill k>1
      \end{equation}
      Integrál druhého zlomku, vypočteme substitucí $x-\alpha=t$ a \(\dd{x} = \dd{t}\), čímž snadno
      dostaneme 
      \begin{equation}\label{mai:eq169}
        \int\frac{A}{(x-\alpha)^k}\dd{x} = \int\frac{A}{t^k}\dd{t}.
      \end{equation}
      Tento integrál se rovná
      % https://tex.stackexchange.com/questions/299407/does-raisetag-actually-do-anything
      \begin{flalign}\label{mai:eq170}
        \boxed{\int\frac{A}{(x-\alpha)^k}\dd{x} = -\frac{A}{k-1}\frac{1}{(x-\alpha)^{k-1}} + c.} &&
        \raisetag{20pt}
      \end{flalign}    
      Výsledek platí na každém intervalu neobsahujícím bod \(\alpha\).
      
      %-------------------------------------
      \input{../src/MAI/exam/exam138.tex}
      %-------------------------------------
      %-------------------------------------
      \input{../src/MAI/exam/exam139.tex}
      %-------------------------------------

      U integrálu třetího zlomku se trochu zapotíme
      \begin{equation}\label{mai:eq137}
        \boxed{f_3(x) = \frac{Bx + D}{x^2+px+q}}
      \end{equation} 
       předpokládáme samozřejmě, že kvadratický trojčlen \(x^2+px+q\) nemá kořeny v reálném oboru,
       takže jej nelze rozložit do tvaru \((x - \alpha)(x - \beta)\) s reálnými \(\alpha\),
       \(\beta\) (\cite[p.~140]{Musilova2009MA1}). Platí 
      \begin{gather*}
        \frac{B}{2}\underbrace{\frac{2x + p}{x^2+px+q}}_{I_1} + 
        \left(D - \frac{Bp}{2}\right)\underbrace{\frac{1}{x^2+px+q}}_{I_2}
      \end{gather*} 
      K čemu byla předchozí úprava dobrá? Původní parciální zlomek jsme napsali jako součet dvou
      zlomků, z nich je v čitateli derivace funkce \(u(x)=x^2+px+q\). První zlomek se tak stává
      kandidátem na použití substituční metody I.
      \begin{equation*}
        I_1=\frac{B}{2}\int{\frac{(2x+p)}{x^2+px+q}\dd{x}}=\frac{B}{2}\int\frac{1}{u^k}\dd{u} ,                   
      \end{equation*}  
      \begin{equation*}
        \boxed{\frac{B}{2}\int{\frac{(2x+p)}{x^2+px+q}\dd{x}} = \frac{B}{2}\ln(x^2+px+q) + c}
      \end{equation*}

      Nemuseli jsme zde psát \(\abs{x^2+px+q}\), neboť kvadratický mnohočlen se záporným
      diskriminantem nabývá pro všechna \(x\) hodnot téhož znaménka, rovného znaménku koeficientu u
      \(x^2\). V našem případě je tento koeficient rovný jedné, takže výraz \(x^2+px+q\) je pro
      všechna \(x\) kladný.   


      Při výpočtu durhého integrálu použijeme procedury \uv{doplnění na čtverec}
      (\cite[p.~407]{Rektorys1963}, \cite[s.~264]{Brabec1989}) takto:
      \begin{equation*}
        x^2 + px + q = \left(x + \dfrac{p}{2}\right)^2 + q -  \left(\dfrac{p}{2}\right)^2.
      \end{equation*}
      Výraz \(q-(p/2)^2\) je jistě kladný, neboť diskriminant \(p^2-4q\) trojčlenu \(x^2+px+q\) je
      podle předpokladu záporný. Položíme-li tedy \(a = \sqrt{q-(p/2)^2}\), můžeme psát 

      \begin{equation}
        I_2 =\int\dfrac{1}{x^2+px+q}\dd{x} 
            =\int{\dfrac{1}{\left(x+\frac{p}{2}\right)^2 + a^2}}\dd{x}
      \end{equation}
      substitucí \(x + \frac{p}{2} = t\), \(\dd{x} = \dd{t}\) dostaneme 
      \begin{gather*}
        \int{\dfrac{1}{\left(x+\frac{p}{2}\right)^2 + a^2}}\dd{x} = 
        \int{\dfrac{1}{t^2+a^2}}\dd{t}
      \end{gather*}
      takže
      \begin{equation*}
        \dfrac{1}{a}\arctan\dfrac{t}{a} + c = \dfrac{1}{a}\arctan\dfrac{x + \frac{p}{2}}{a} + c 
      \end{equation*}
      Je tedy
      \begin{align}
          &\int\dfrac{1}{x^2+px+q}\dd{x} = \frac{B}{2}\ln(x^2+px+q) +              \notag     \\ 
        + &\frac{1}{\sqrt{q-\left(\frac{p}{2}\right)^2}}
                \arctan\frac{x+\frac{p}{2}}{\sqrt{q-\left(\frac{p}{2}\right)^2}}.  \label{mai:eq171}
      \end{align}
     
      %-------------------------------------
      \input{../src/MAI/exam/exam140.tex}
      %------------------------------------- 

      Zbývá vyřešit nejpracnější problém, určit primitivní funkci ke zlomku 4. typu
      \begin{mdframed}[style=mdeq] 
        \begin{equation}\label{mai:eq172}
          f_4(x) = \frac{Bx + D}{(x^2+px+q)^k} \qquad k>1
        \end{equation}      
      \end{mdframed}
      
      Nejdříve prozkoumáme integrál, se kterým jsme se setkali v předchozím příkladu pro případ
      \(k = 2\) (viz \cite[p.~141]{Musilova2009MA1}). Jedná se o integrál typu 
      \begin{equation*}
        \int{1\cdot\dfrac{1}{(t^2 + 1)^{2}}\dd{t}}.
      \end{equation*}
      Integrál vyjádříme nikoli jako arkustangentu, ale pomocí metody per partes, pro kterou zvolíme
      \(u'(t)=1\rightarrow u(t)=t\), \(v(t) = \dfrac{1}{t^2+1}\rightarrow v'(t) =
      \dfrac{2t}{(t^2+1)^2}\),
      \begin{gather*} 
        \begin{align*}
          \arctan u &=  \int{1\cdot\dfrac{1}{(t^2 + 1)^{2}}\dd{t}}              \\
                    &=  \dfrac{u}{1+u^2} + \int\dfrac{2u^2}{(1+u^2)^2}\dd{u},   \\
                    &=  \dfrac{u}{1+u^2} + \int\dfrac{2(1+u^2)}{(1+u^2)^2}\dd{u}
                                        - \int\dfrac{2\dd{u}}{(1+u^2)^2}      \\
          \arctan u &=  \dfrac{u}{1+u^2} + 2\arctan u - 2\int\dfrac{\dd{u}}{(1+u^2)^2}  
        \end{align*}
      \end{gather*}  
      Odtud již můžeme požadovaný integrál vyjádřit jako
      \begin{equation*}
        \int\dfrac{1}{(1+u^2)^2}\dd{u} = \dfrac{1}{2}\left(\dfrac{u}{1+u^2} + \arctan u\right) + c. 
      \end{equation*}

      Integrál pro \(k=2\) jsme vyjádřili pomocí arkustangenty, tj. pomocí integrálu pro \(k=1\).
      Metodou per partes aplikovanou na integrál
      \begin{equation*}
        I_{k-1} = \int1\cdot\dfrac{1}{(1+u^2)^{k-1}}\dd{u}
      \end{equation*}
      můžeme vyjádřit integrál \(I_k\) pomocí \(I_{k-1}\) a získat \emph{rekurentní vzorec}
      \begin{align}
        I_k &= \int\dfrac{1}{(1+u^2)^k}\dd{u}                                   \label{mai:eq165} \\
            &= \dfrac{1}{2(k-1)}\left[\dfrac{u}{(1+u^2)^{k-1}}+(2k-3)I_{k-1}\right]  \notag
      \end{align}

      Nyní jsme připraveni řešit \ref{mai:eq172} obecně. I zde, dříve než přistoupíme k integrování,
      rozložíme zlomek obdobným způsobem jako v předcházejícím případě:
      \begin{gather*}
        \frac{B}{2}\underbrace{\frac{2x + p}{(x^2+px+q)^k}}_{I_3} + 
        \left(D - \frac{Bp}{2}\right)\underbrace{\frac{1}{(x^2+px+q)^k}}_{I_4}
      \end{gather*} 
      Integrál \(I_3\) určíme snadno substitucí \(x^2+px+q = z\), \((2x+p)\dd{x} = \dd{z}\),
      \begin{align}
        I_3 &= \frac{B}{2}\int\dfrac{1}{(x^2+px+q)^k}\dd{x} 
             = \frac{B}{2}\int\dfrac{\dd{z}}{z^k} =                                \notag   \\
            &=-\frac{B}{2}\dfrac{1}{k-1}\dfrac{1}{z^{k-1}} + c                     \notag   \\
            &=-\frac{B}{2(k-1)}\dfrac{1}{(x^2+px+q)^{k-1}} + c                     \label{mai:eq173} 
      \end{align}      

      Druhý integrál \(I_4\) převedeme opět úpravami obdobnými těm, kterých jsme použili u zlomku
      \ref{mai:eq137} na tvar \(1/(t^2+a^2)^k\):
      \begin{align*}
        I_3 &= \left(D - \frac{Bp}{2}\right)\int\dfrac{1}{(x^2+px+q)^k}\dd{x}      \notag   \\  
            &= \left(D - \frac{Bp}{2}\right)\int\dfrac{1}{
                  \left[
                    \left(
                      x+\frac{p}{2}
                    \right)^2+q-
                    \left(
                      \frac{p}{2}
                    \right)^2
                  \right]^k
                }\dd{x}.
      \end{align*}    

      V integrálu na pravé straně provedeme substituci \(x + \frac{p}{2} = t\), \(\dd{x} = \dd{t}\),
      a položíme 
      \begin{equation*}
        \sqrt{q - \left(\dfrac{p}{2}\right)^2} = a.
      \end{equation*}
      dostaneme
      \begin{equation*}
        \left(D - \frac{Bp}{2}\right)\int\dfrac{1}{(t^2+a^2)^k}\dd{t}.
      \end{equation*}
      Pro integrál na pravé straně zavedeme označení
      \begin{equation*}
        \int\dfrac{1}{(t^2+a^2)^k}\dd{t} = I_k
      \end{equation*}
      a odvodíme pro jeho výpočet rekurentní vzorec. Integrál \(I_k\) nejprve upravíme:
      \begin{align*}
        I_k &= \int\dfrac{1}{(t^2+a^2)^k}\dd{t} 
             = \dfrac{1}{a^2}\int\dfrac{t^2+a^2-t^2}{(t^2+a^2)^k}\dd{t}                       \\
            &= \dfrac{1}{a^2}\underbrace{\int\dfrac{1}{(t^2+a^2)^{k-1}}\dd{t}}_{I_{k-1}}          
             - \dfrac{1}{a^2}\underbrace{\int\dfrac{t^2}{(t^2+a^2)^k}\dd{t}}_{I_5}                
      \end{align*}

      První integrál na pravé straně, jsme ve shodě se zvoleným označením pro \(I_k\), označili
      \(I_{k-1}\). Na druhý integrál použijeme metody integrování per partes. Položíme 
      \begin{alignat*}{2}
        u  &= t, \quad v' &&=   \dfrac{t}{(t^2+a^2)^k} = \dfrac{1}{2}\dfrac{2t}{(t^2+a^2)^k}   \\
        \shortintertext{a dostaneme}
        u' &= 1, \quad v  &&= - \dfrac{1}{2(k-1)}\dfrac{1}{(t^2+a^2)^{k-1}}.
      \end{alignat*}
      Bude
      \begin{alignat}{2}
        I_5 &=  &&{} \int\dfrac{t^2}{(t^2+a^2)^k}\dd{t} =
                     \int\dfrac{t\cdot t}{(t^2+a^2)^k}\dd{t}                 \notag \\
            &=  &&-  \dfrac{1}{2(k-1)}\cdot\dfrac{t}{(t^2+a^2)^{k-1}} +      \notag \\
            &{} &&+  \dfrac{1}{2(k-1)}\int\dfrac{1}{(t^2+a^2)^{k-1}}\dd{t}.  \label{mai:eq174}
      \end{alignat}
      Dosadíme-li tento výsledek do rovnice pro \(I_k\), dostaneme
      \begin{gather}
        \begin{aligned}
        I_k &= \dfrac{1}{a^2}I_{k-1} - \dfrac{1}{a^2}
              \left[
                -\dfrac{1}{2(k-1)}\dfrac{1}{(t^2+a^2)^{k-1}} + \dfrac{1}{2(k-1)}I_{k-1}                
              \right]                                                                            \\
        \shortintertext{čili}     
        I_k &= \dfrac{t}{2(k-1)a^2(t^2+a^2)^{k-1}} + 
               \dfrac{1}{a^2}\left(1-\dfrac{1}{2(k-1)}\right)I_{k-1}                      \notag \\               
        \shortintertext{a konečně}
        I_k &= \dfrac{t}{2(k-1)a^2(t^2+a^2)^{k-1}} + 
              \dfrac{2k-3}{2k-2}\dfrac{1}{a^2}I_{k-1}                              \label{mai:eq175}
      \end{aligned}  
    \end{gather}

      Pomocí vzorce \ref{mai:eq175} se redukuje výpočet integrálu \(I_k\) na výpočet integrálu
      \(I_{k-1}\) je tabulkový. Přejdeme-li zpět k proměnné \(x\) a uvážíme \ref{mai:eq173},
      dostaneme hledaný integrál funkce
      \begin{equation*}
        \dfrac{Bx + D}{(x^2+px+q)^k}
      \end{equation*}

      %-------------------------------------
      \input{../src/MAI/exam/exam141.tex}
      %-------------------------------------  
      
    % ---------------- Rozklad ryze lomené funkce v parciální zlomky -------------------------------
    \subsubsection{Rozklad ryze lomené funkce v parciální zlomky}
    Nechť je dána racionální funkce $R = \frac{P}{Q}$ s reálnými koeficienty. Můžeme
    předpokládat, že je \emph{ryze lomená}\footnote{tj. stupeň polynomu $P$ je menší než
    stupeň polynomu $Q$}. Pokud by tomu tak nebylo, dostaneme dělením čitatele jmenovatelem
    zlomku součet polynomu a ryze lomené racionální funkce.

    %-------------------------------------
    \input{../src/MAI/exam/exam136.tex}
    %-------------------------------------

    Soustavu rovnic v příkladu \ref{MAI:exam136} pro výpočet koeficientů \(A\), \(B\), \(C\)
    dostaneme též dosazením tří libovolných čísel do rovnice \ref{mai:eq162} (polynomy jsou si
    rovné, tedy mají stejné hodnoty pro libovolné \(x\)), aniž na pravé straně uspořádáme podle
    mocnin \(x\). Dosadíme-li postupně \(x=0\), \(x=-1\), \(x=1\) (tedy právě kořeny jmenovatele),
    dostaneme ihned \(2=-A\), \(1=2B\), \(3=2C\) a odtud už snadno hledané koeficienty. Rovnost
    \ref{mai:eq163} platí ovšem pro všechna \(x\) s výjimkou právě kořenů  \(x=0\), \(x=-1\) a
    \(x=1\).

    %-------------------------------------
    \input{../src/MAI/exam/exam137.tex}
    %-------------------------------------

    Obdobný postup při určování koeficientů \(A\), \(B\), \(C\) a \(D\) zde není tak výhodný jako
    v příkladu \ref{MAI:exam136}, protože jmenovatel nemá reálné různé kořeny. 

    %-------------------------------------
    \input{../src/MAI/exam/exam128.tex}
    %-------------------------------------

    %-------------------------------------
    \input{../src/MAI/exam/exam129.tex}
    %-------------------------------------
    
    %-------------------------------------
    \input{../src/MAI/exam/exam115.tex}
    %-------------------------------------
      
  % -----------------------Funkce typu {f(x)=\sqrt{ax+b}} ------------------------------------
  \twocolumn[\subsection{Integrály iracionálních funkcí}]
    \subsubsection*{Funkce typu $\boxed{f(x)=\sqrt{ax+b}}$ :}
      Funkci, jež je dána rovnicí, jež obsahuje polynomy proměnné x  ve výrazu $\sqrt{ax+b}$,
      v němž $ax+b>0$, $a>0$, integrujeme pomocí substituce:
      \begin{equation}\label{ma:eq_sub_fce1}
          u=\sqrt{ax+b},\quad du=\frac{1}{2}\frac{a}{u}dx,\quad dx=2\frac{u}{a}du
      \end{equation}
      Je-li potřeba dosadit do integrované funkce také za $x$, vyjádříme ze substituční
      rovnice $x=\frac{u^2-b}{a}$.
    % ----------------------Funkce typuf(x)=\frac{1}{\sqrt{x^2+a}}, a\neq0 -------------------- 
    \subsubsection*{Integrál typu $\boxed{\int\frac{1}{\sqrt{x^2+a}}\dd{x}}, a\neq0$ :}
      \(\int\frac{1}{\sqrt{x^2+a}}\dd{x}\):\vskip0.5mm
      Užijeme \textbf{Eulerovu substituci}: \(u=x+\sqrt{x^2+a}\), a dostáváme
      \(\dd{u}=\dfrac{u}{\sqrt{x^2+a}}\dd{x}\), \(\dfrac{\dd{u}}{u}=\dfrac{1}{\sqrt{x^2+a}}\dd{x}\).
      \begin{equation}
        \int{\frac{\dd{u}}{u}}=\ln\abs{u} =\ln\left\lvert x+\sqrt{x^2+a}\right\rvert+c
      \end{equation}
  % --------------------------Integrály goniometrických funkcí------------------------------------
  \newpage
  \subsection{Integrace goniometrických funkcí}
    \subsubsection{Integrály tvaru \(\int R(\cos x, \sin x)\dd{x}\) kde \(R(u, v)\) je racionální
    funkce}
      Zavedeme substituci \(\tan(x/2)\). Užitím základních vztahů mezi goniometrickými funkcemi
      dostáváme 
      \begin{equation}\label{mai:eq164}
        \cos^2\dfrac{x}{2} = \dfrac{1}{1+ \tan^2\dfrac{x}{2}} = \dfrac{1}{1+t^2},
      \end{equation}
  % ---------------- Sbírka řešených příkladů ------------------------------------------------------
  \section{Sbírka řešených příkladů}
    \begin{excercise}\label{mai:cviko001}
      Hledejme primitivní funkce \(F(x)\) k následujícím funkcím
      \begin{flalign}
        &\int{xe^x\dd{x}},                                                      &\label{mai:eq140}\\
        &\int\frac{x}{x^2+1}\dd{x}                                              &\label{mai:eq141}\\
        &\int{\arctan x\dd{x}},                                                 &\label{mai:eq142}\\
        &\int{\frac{2x^4-5x^2+14x+13}{x^2-x-2}\dd{x}}                           &\label{mai:eq144}\\
        &\int{\sqrt{x^2+a}\dd{x}}, \quad a\neq0, x^2+a>0,                       &\label{mai:eq143}
      \end{flalign}
    \end{excercise}

    I když jsme již zdůraznili, že hbitému hledání a nalézání primitivních funkcí se lze naučit
    jedině praxí, tj. tak, že budeme „počítat, počítat, počítat“, přece jen si ještě ukážeme
    složitější příklady, v nichž se kombinují substituční metody s metodou per partes. Uvidíme však,
    že triky“, které při výpočtu nejvíce pomohou, nespočívají často v těchto metodách samotných, ale
    jsou spíše založeny na představivosti počtáře při úpravě obyčejných středoškolských vzorců.

    \input{../src/MAI/exam/exam112.tex}
    \input{../src/MAI/exam/exam123.tex}
    \input{../src/MAI/exam/exam113.tex}
    \input{../src/MAI/exam/exam016.tex}
    \newpage
    \input{../src/MAI/exam/exam114.tex}
    %-------------------------------------
    \newpage
    \begin{excercise}\label{mai:cviko002}
      Hledejme primitivní funkce \(F(x)\) k následujícím funkcím
      \begin{flalign}
        &\int\frac{3}{(1+x^2)x^2}\dd{x}                                         &\label{mai:eq146}\\
        &\int\cos^2\frac{x}{2}\dd{x}                                            &\label{mai:eq148}\\
        &\int\frac{\cos2x}{\cos^2x\cdot\sin^2x}\dd{x}                           &\label{mai:eq150}\\
        &\int{\frac{x^4+3x^3-3x^2+3x}{x^2+1}\dd{x}}                             &\label{mai:eq145}\\
        &\int{\sqrt{1+\cos2x}\dd{x}}                                            &\label{mai:eq147}\\
        &\int{\tan^2x}\dd{x}                                                    &\label{mai:eq149}\\
        &\int\frac{1}{\cos x\cdot\sin x}\dd{x}                                  &\label{mai:eq151}
      \end{flalign}
    \end{excercise}

    \input{../src/MAI/exam/exam130.tex}
    \input{../src/MAI/exam/exam132.tex}
    \input{../src/MAI/exam/exam133.tex}
    \input{../src/MAI/exam/exam121.tex}
    \input{../src/MAI/exam/exam131.tex}
    \input{../src/MAI/exam/exam127.tex}
    \input{../src/MAI/exam/exam134.tex}
    %-------------------------------------
    \newpage
    \begin{excercise}\label{mai:cviko003}
      Z toho, co jsme uvedli, vyplývá, jak postupujeme při rozkladu racionální lomené funkce na
      parciální zlomky:
      \begin{enumerate}[label=\roman*]
        \item Není-li funkce ryze lomená, převedeme ji dělením čitatele jmenovatelem na součet
              polynomu a ryze lomené racionální funkce. Dále upravujeme ryze lomenou racionální
              funkci.
        \item Rozložíme jmenovatele v reálném oboru.
        \item Napíšeme rozklad na parciální zlomky podle věty o rozkladu.
        \item Najdeme koeficienty parciálních zlomků metodou neurčitých součinitelů.
      \end{enumerate}
      Příklady integrace racionálních funkcí. Čerpáno z \cite[p.~271]{Brabec1989}
      \begin{flalign}
        &\int\dfrac{x+2}{x^3-x}\dd{x},                                          &\label{mai:eq152}\\
        &\int\dfrac{2x^3 + x + 2}{x^4 + x^3 + x^2}\dd{x}                        &\label{mai:eq153}\\
        &\int\dfrac{x^2 + x}{x^2 + x}\dd{x},                                    &\label{mai:eq154}\\
        &\int\dfrac{2x - 1}{x^2 - 5x - 6}\dd{x}                                 &\label{mai:eq155}\\
        &\int\sqrt{x^2+a}\dd{x}, \quad a\neq0, x^2+a>0,                         &\label{mai:eq156}
      \end{flalign}
    \end{excercise}
    
%---------------------------------------------------------------------------------------------------