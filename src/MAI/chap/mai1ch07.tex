% !TeX spellcheck = cs_CZ
%---------------------------------------------------------------------------------------------------
% file: mai1ch07.tex
%---------------------------------------------------------------------------------------------------
%============================ Primitivní funkce ====================================================
\setchaptertoc
\chapter{Poznáváme funkci z její derivace - neurčitý integrál}
  %----------------------------Neurčitý integrál----------------------------------------------------
  \section{Motivace}
    Problém \emph{neurčitého integrálu}, neboli \textbf{primitivní funkce}, lze vyložit velmi 
    jednoduše: Máme podezření, že zadaná funkce \(f(x)\) vznikla derivováním jisté, zatím neznámé, 
    funkce \(F(x)\). Dokážeme ji najít? 
  
    K danému problému můžeme přistupovat také fyzikálně: Zavedením pojmu derivace funkce jsme 
    motivovali důležitým požadavkem definovat okamžitou rychlost pohybu bodu po přímce. Existuje 
    přirozeně i požadavek opačný, tj. nalézt zákon dráhy pohybu bodu po přímce, je-li dána jeho 
    okamžitá rychlost jako funkce času \cite[s.~253]{Brabec1989}. Vše si ukážeme na následujícím 
    příkladu:      
    %-------------------------------------
    \input{../src/MAI/exam/exam117.tex}
    %-------------------------------------
    Každé takové funkci, jejíž derivací je daná funkce, budeme říkat \emph{primitivní funkce} k 
    dané funkci. Na uvedeném příkladě je patrné, že k dané funkci může existovat nekonečně mnoho 
    primitivních funkcí. Množinu všech primitivních funkcí se často nazývá \textbf{neurčitým 
    integrálem}. Po tomto názorném uvedení do problému přejděme k přesné formulaci základních pojmů.
    
  \section{Definice primitivní funkce}  
    \begin{mdframed}[style=mdmathdef] 
      \begin{definition}\label{mai:def002}
        Funkci \(F(x): J\rightarrow \realset\), kde \(J\subset \realset\) je interval, nazveme
        \textbf{primitivní} funkcí k funkci \(f(x)\) na intervalu \(J\) právě když, pro všechna
        \(x\in J\) je \(F'(x) = f(x)\). 
        
        V případě uzavřeného intervalu \(J=[a,b]\) požadujeme ještě, aby obě jednostranné derivace
        splňovali \(F_+'(a)=f(a)\) a \(F_-'(b)=f(b)\). 
        
        Množina všech primitivních funkcí k funkci \(f(x)\) na \(J\) se nazývá \textbf{neurčitý
        integrál} z funkce \(f(x)\) a značí se \(\int f(x)\dd{x}\). Tedy
        \begin{equation}\label{mai:eq101}
          \int f(x)\dd{x} = \{F(x): \text{\(F(x)\) je primitivní funkcí k \(f(x)\) na \(J\)}\}
        \end{equation}
      \end{definition}
    \end{mdframed}
    %-------------------------------------
    \input{../src/MAI/exam/exam118.tex}
    %-------------------------------------
    
    Z uvedených příkladů je vidět, že rozdíl dvou primitivních funkcí k téže funkci je konstanta. To
    není náhoda, jak potvrzuje následující věta:

    \begin{mdframed}[style=mdmathlemma] 
      \begin{lemma}\label{mai:lemma008}(Věta o rozdílu dvou primitivních funkcí)
        \begin{enumerate}[noitemsep]
          \item Je-li funkce $F$ primitivní funkcí k funkci \(f\) na intervalu \(J\) a \(c\) reálná  
                konstanta, pak i funkce $G = F + c$ je primitivní funkcí k funkci \(f\) na intervalu 
                \(J\).
          \item Jsou-li funkce $F$ a $G$ primitivní funkce k funkci \(f\) na intervalu \(J\), pak 
          funkce
                $F-G$ je na intervalu \(J\) konstantní.
        \end{enumerate} 
        \begin{proof}
          Tvrzení a) plyne z definice protože $G'(x) = [F(x) + c] = F'(x) = f(x)$ pro všechna $x\in
          J$. Tvrzení b) je důsledkem věty \ref{MA1:lem_diff01}.
        \end{proof}
      \end{lemma}
    \end{mdframed}

    \subsection{Poznámky k definici}  
      Z definice \ref{mai:def002} vyplývá, že primitivní funkce je spojitou funkcí, neboť má
      derivaci a věta \ref{mai:lemma008} nám říká, že pokud k dané funkci existuje funkce
      primitivní, existuje jich nekonečně mnoho. Je-li např. \(F\) primitivn9 funkce k funkci \(f\)
      na intervalu \(J\), pak množina všech primitivních funkcí je množina \(\{F + c;
      c\in\realset\}\). Tuto množinu označujeme symbolem \(\int f(x)\dd{x}\) a čteme \uv{integrál
      \(f(x)\dd{x})\)} Symbolu \(\int f(x)\dd{x}\) říkáme \textbf{neurčitý integrál}. Zpravidla
      píšeme
      \begin{mdframed}[style=mdmathlemma]  
        \begin{equation}\label{mai:eq102}
          \int f(x)\dd{x} = F(x) + c
        \end{equation}
      \end{mdframed}
      nebo jen \(\int f(x)\dd{x} = F(x)\) (tj. aditivní konstantu vynecháváme) a máme tím na mysli
      že \(F(x) \in \int f(x)\dd{x}\). Rovnost \ref{mai:eq102} je tedy rovnost mezi množinami,
      nikoliv rovnost funkcí. 
    
    \subsection{Některé vlastnosti integrálů}  
      Platnost několika následujících vztahů lze prověřit přímo užitím deﬁnic derivace a neurčitého
      integrálu. Tyto vztahy jsou při výpočtech často používány. Nejprve však uvedeme základní
      pravidla pro primitivní funkce, která plynou z pravidel pro derivování:
      \begin{subequations}
        \begin{flalign}
          \int\dd{f(x)} &= f(x) + c,                                          &\label{mai:eq134} \\
          \dxd\left[\int f(x)\dd{x}\right] &= f(x)\dd{x},                     &\label{mai:eq135} \\
          \int[f(x)\pm g(x)]\dd{x}&= \int f(x)\dd{x} + \int g(x)\dd{x},       &\label{mai:eq103} \\
          \int kf(x)\dd{x}      &=k\int f(x)\dd{x},\quad\text{\(k=\) konst.}, &\label{mai:eq104} \\
          \left[\int f(x)\dd{x}\right]' &= f(x),                              &\label{mai:eq136}
        \end{flalign}
      \end{subequations}
  
  \section{Tabulka neurčitých integrálů}\label{MA:chap_tabINT}
    Jak ale primitivní funkce hledat? V jednoduchých příkladech poslouží tabulka derivací, již čteme
    „zprava doleva“. (Je dobré si ji uložit do paměti.) Tabulka však pokryje jen velmi málo případů,
    pouze elementární funkce. Je tedy třeba najít metody, jak při hledání primitivních funkcí
    postupovat.

    Uveďme nyní některé základní integrály. Poznamenejme, že touto tabulkou nejsou zdaleka vyčerpány
    všechny funkce, ke kterým umíme primitivní funkce najít. Existují celé knihy obsahující tabulky
    integrálů a programy výrazně ulehčující hledání primitivních funkcí. Literatura:
    \cite{Rektorys1963}, \cite{Brabec1989}, \cite{diblik2002}. 

    Pokud není nic uvedeno, platí vzorce pro všechna \(x\) a pro všechny hodnoty uvedených konstant.
    Místo platí pro \(x\) z intervalu \((-\infty,0),(0,+\infty)\) píšeme stručně \(x\neq0\) apod.
    Obory platnosti uvádíme jen tam, kde nejsou evidentní.  

    \begin{flalign}
      \midrule
      & \int 0\dd{x} = c                                        &      \label{mai:eq105}     \\
      & \int a\dd{x} = ax+c                                     &      \label{mai:eq106}     \\
      & \int x^n\dd{x} = \frac{x^{n+1}}{n+1}+c,                 &      \label{mai:eq107}     \\              
        \shortintertext{\hspace{2em} kde \(\begin{cases}
          \forall x\in\realset,\,n\in\naturalset, n>0,         \\
          \forall x\in\realset-\{0\},\,n\in\naturalset, n<-1,  \\
          \forall x>0,\,n\in\realset\,\,n\neq-1
        \end{cases}\)}                                          
      & \int\frac{1}{x}\dd{x} = 
            \ln\abs{x}+c \hspace{1ex}\forall x\neq0            &       \label{mai:eq108}    \\
      & \int e^x \dd{x}       = e^x+c                          &       \label{mai:eq109}    \\
      & \int\ln x\dd{x}       = 
          x\ln x - x + c \hspace{1ex}\forall x>0               &       \label{mai:eq110}    \\
      & \int a^x \dd{x}     =
        \frac{a^x}{\ln a}+c 
        \hspace{1ex}\forall a>0,\,a\neq1                       &       \label{mai:eq111}    \\
      & \int \sin x \dd{x}  = -\cos x                          &       \label{mai:eq112}    \\
      & \int \cos x \dd{x}  =  \sin x                          &       \label{mai:eq113}    \\
      & \int\frac{1}{\cos^2x}\dd{x} =  \tan x + c              &       \label{mai:eq114}    \\
        \shortintertext{\(\hspace{2em}\forall x\neq\frac{1}{2}\pi+k\pi,\,k\in\naturalset\)}\nonumber\\       
      & \int\frac{1}{\sin^2x}\dd{x}     =  -\cotg x+c         &        \label{mai:eq115}    \\
        \shortintertext{\(\hspace{1em}\forall x\neq k\pi,\,k\in\naturalset\)}
      & \int\frac{1}{\sqrt{1-x^2}}\dd{x} =
          \begin{cases}
            +\arcsin x + c         \\
            -\arccos x + c
          \end{cases}                                          &       \label{mai:eq116}    \\
        \shortintertext{\(\hspace{2em}\forall x\in(-1,1) \)}  
     & \int\sinh x\dd{x} = \cosh x + c                         &       \label{mai:eq117}    \\
     & \int\dfrac{1}{\sinh x}\dd{x} = -\cotgh x + c            &       \label{mai:eq118}    \\
     & \int\cosh x\dd{x} = \sinh x + c                         &       \label{mai:eq119}    \\
     & \int\dfrac{1}{\cosh x}\dd{x} = -\tanh x + c             &       \label{mai:eq120}    \\
     & \int\frac{1}{1+x^2}\dd{x} = \arctan x + c               &       \label{mai:eq121}    \\
     & \int\frac{1}{\sqrt{x^2 + 1}}\dd{x} =
         \begin{cases}
            \ln(x + \sqrt{x^2+1}) + c         \\
            \arcsinh x            + c 
         \end{cases}                                           &       \label{mai:eq122}    \\ 
     & \int \frac{1}{\sqrt{x^2 - 1}}\dd{x} =
         \begin{cases}
            \ln(x + \sqrt{x^2-1}) + c         \\
            \arccosh x            + c  
         \end{cases}                                           &       \label{mai:eq123}    \\   
       \shortintertext{\hspace{2em}\(x\in(1,+\infty)\)}  
     & \int\frac{1}{\sqrt{x^2+a^2}}\dd{x} 
         = \begin{cases}
              \arcsinh\frac{x}{a}   + c  \\ 
              \ln(x+\sqrt{x^2+a^2}) + c     
           \end{cases}                                          &      \label{mai:eq124}    \\
     & \int \frac{1}{\sqrt{x^2-a^2}}\dd{x} 
         = \begin{cases}
              \arccosh\frac{x}{a}   + c   \\
              \ln(x+\sqrt{x^2-a^2}) + c
           \end{cases}                                          &      \label{mai:eq125}    \\
     & \int\tan x \dd{x}   = \ln\abs{\sec x} + c                &      \label{mai:eq126}    \\
     & \int\sec x \dd{x}   = \ln\abs{\sec x + \tan x} + c       &      \label{mai:eq127}    \\
     & \int\sec^2 x \dd{x} = \tan x + c                         &      \label{mai:eq128}    \\
     & \int\sec x\tan x \dd{x} = \sec x + c                     &      \label{mai:eq129}    \\
     & \int\frac{a}{a^2+x^2}\dd{x} = \tan^{-1}\frac{x}{a} + c   &      \label{mai:eq130}    \\
     & \int\frac{a}{a^2-x^2}\dd{x} = 
       \frac{1}{2}\ln\left\lvert\frac{x+a}{x-a}\right\rvert     &      \label{mai:eq131}    \\
     & \int\frac{1}{\sqrt{a^2-x^2}} \dd{x} = 
       \sin^{-1} \frac{x}{a}                                    &      \label{mai:eq132}    \\
     & \int\frac{a}{x\sqrt{x^2-a^2}}\dd{x} = 
       \sec^{-1} \frac{x}{a}                                    &      \label{mai:eq133}    
    \end{flalign}

  \section{Metody určení primitivní funkce}
    Procesu hledání primitivní funkce se často říká integrování nebo integrace (od slova“integrál”),
    což z matematického hlediska znamená provést inverzní operaci k operaci derivování. Smutnou
    zprávou je, že na rozdíl od derivování neexistuje obecný vzorec pro integrování součinu či
    podílu, ani obecný vzorec pro integrování složených funkcí. Při hledání integrálů složitějších
    funkcí se využívá např. \emph{linearita, metoda per partes, substituční metoda}, popř. některé
    další speciální metody. Řešitel v mnoha případech musí projevit důvtip a intuici, která mu
    pomůže nalézt primitivní funkci k dané funkci.
  
    % --------------------------Integrace po částech - per partes-----------------------------------
    \subsection{Integrace po částech - per partes}
      Metoda integrace \emph{per partes} neboli \emph{po částech} využívá vzorce pro derivaci 
      součinu funkcí. Připomeňme si jej: Pro derivaci součinu dvou funkcí \(u(x)\) a \(u(x)\) platí
      \cite[p.~137]{Musilova2009MA1}.
      \begin{equation}\label{MA:eq_Int29}
        [u(x)v(x)]' = u(x)'v(x) + u(x)v'(x).
      \end{equation} 
      Primitivní funkcí levé strany je \(F(x) = u(x)v(x)\), a tedy
      \begin{equation*}
        u(x)v(x) =  \int u'(x)v(x)\dd{x} + \int u(x)v'(x)\dd{x}
      \end{equation*}  
      za předpokladu, že existují obě primitivní funkce na pravé straně. K čemu může tento
      samozřejmý vzorec sloužit při hledání primitivní funkce? Dejme tomu, že zadaná funkce
      \(f(x)\), k níž máme hledat funkci primitivní, je tvaru \(f(x) = u'(x)v(x)\), a my si s ní
      nevíme rady. Je však možné, že bychom si docela dobře poradili s primitivní funkcí k funkci
      \(g(x) = u(x)v(x)\). A předchozí vzorec umožňuje nahradit výpočet neurčitého integrálu z
      funkce \(f(x)\) výpočtem neurčitého integrálu z funkce \(g(x)\), tedy
      \begin{equation}\label{ma:eq_perpartes}
        \int u'(x)v(x)\dd{x} = u(x)v(x) - \int u(x)v'(x)\dd{x} 
      \end{equation}

      %-------------------------------------
      \input{../src/MAI/exam/exam111.tex}
      %-------------------------------------

      Není vždy jednoduché rozpoznat, jak máme rozložit funkci \(f(x)\) na součin funkcí \(u'(x)\) 
      a \(v(x)\). Takový rozklad není určen jednoznačně a požadavek na něj bychom mohli (dosti 
      nepřesně) formulovat tak, aby funkce \(v'(x)\) byla jednodušší než v \(v(x)\) (například 
      derivováním polynomu se snižuje jeho stupeň) a funkce \(u'(x)\) a \(u(x)\) aby byly zhruba 
      „stejně složité“ (například \(u'(x) =e^x\), \(u(x) = e^x\), nebo \(u'(x) = \cos x\), \(u(x) = 
      \sin x\), apod.). Spolehlivě používat metodu per partes se však můžeme naučit pouze studiem 
      vyřešených příkladů z literatury a praktickým procvičováním \cite[p.~138]{Musilova2009MA1}.
  
      %-------------------------------------
      \input{../src/MAI/exam/exam109.tex}
      %-------------------------------------
  
    %--------------------------- Substituční metoda ----------------------------------------------
    \subsection{Substituční metoda I}
      Tato metoda \emph{substituce} neboli \emph{náhrady} spočívá v tom, že vhodně zvolenou funkci
      obsaženou v předpisu \(f(x)\) označíme jako novou jednoduchou proměnnou. Čeho tím dosáhneme?
      Předpokládejme například, že \[f(x)=\varphi'(x)g[\varphi(x)]\] a označme jako novou proměnnou
      \(u = f(x)\). Že to vypadá, jako bychom se chystali použít vzorec pro derivaci složené funkce?
      Správně! Dejme tomu, že známe primitivní funkci \(G(u)\) k funkci \(g(u)\). Pak platí
      \begin{equation*}
        \left[G\left(\varphi(x)\right)\right]' = G'\left[\varphi(x)\right]\cdot\varphi'(x) 
        = g\left[\varphi(x)\right]\cdot\varphi'(x),     
      \end{equation*}
      a tedy
      \begin{equation*}
        \int \varphi'(x) g\left[\varphi(x)\right]\dd{x} =  G\left[\varphi(x)\right]. 
      \end{equation*}      
      Na základě těchto úvah formulujeme následující větu:
      \begin{lemma}
        Jestliže
        \begin{equation}\label{ma:eq_subst1}
          \int{f(u)du}=F(u)+c
        \end{equation}
        a $u=\varphi(x)$, pak
        \begin{equation}\label{ma:eq_subst2}
            \int{f[\varphi(x)]\varphi'(x)du}=F(\varphi(x))+c
        \end{equation}
      \end{lemma}
  
      Základem úspěchu při aplikací věty je správný výběr funkce $\varphi(x)$. Praxe je totiž
      taková, že výpočet konkrétních příkladů je schématicky veden od rov. \ref{ma:eq_subst2} ke
      vzorci rov. \ref{ma:eq_subst1}.

      %-------------------------------------
      \input{../src/MAI/exam/exam110.tex}
      %-------------------------------------
      
      \begin{example}\label{ma:ex_sub_metoda}$\displaystyle\int{e^{x^{x^2}}dx}$
        \begin{equation*}
            \int{e^{x^{x^2}}dx}=
               \left[
                 \begin{array}{c}u=x^2 \\ du=2xdx\end{array}
               \right]=
               \frac{1}{2}\int{e^udu}=\frac{1}{2}e^u=\frac{1}{2}e^{x^2} + c.
        \end{equation*}
      \end{example}
      
      \begin{example}$\displaystyle\int{x^3e^{x^4}}dx \qquad x\in R$
        \begin{align*}
          \displaystyle\int{x^3e^{x^4}}dx
             &= 
             \left[
               \begin{array}{cc}
                  u=x^4   & du=4x^3dx \Rightarrow \displaystyle\frac{du}{4} = x^3dx  \\
               \end{array}
             \right]                                                                           \\
             &= \frac{1}{4}\int{e^u}du = \frac{e^u}{4} = \frac{e^{x^4}}{4} + c 
        \end{align*}
      \end{example}

    % -------------------Substituční metoda II------------------------------------------------------
    \subsection{Substituční metoda II}
      Druhý typ substituční metody spočívá naopak v tom, že na místo původní proměnné \(x\) 
      dosadíme vhodnou funkci \(x = \psi(t)\). Místo primitivní funkce k funkci \(f(x)\) pak 
      hledáme primitivní funkci k funkci \(g(t) = f[\psi(t)]\psi'(t)\). Skutečně, je-li \(F(x)\) 
      primitivní funkcí k \(f(x)\), pak derivací složené funkce \(G(t) = F[\psi(t)]\) dostaneme
      \begin{equation*}
       G'(t) = F'[\psi(t)]\psi'(t) = f[\psi(t)]\psi'(t) = g(t).
      \end{equation*}
      
      \begin{example} Náhrada proměnně \(x\) funkcí
        Typické jsou neurčité integrály, které vedou na goniometrické substituce, například
        \[\int\sqrt{1-x^2}\dd{x}\]
        
        Označme \(x=\psi(t)=\sin(t)  \Rightarrow \psi'(t)=\cos(t)\) a můžeme psát
        \begin{align*}
          \int\sqrt{1-x^2}\dd{x} 
            &= \int\sqrt{1-\sin^2t}\cos t\dd{t}                      \\
            &= \int\cos^2 t \dd{t} = \int\frac{1+\cos2t}{2}\dd{t}    \\
          = \frac{1}{2}t+\frac{\sin2t}{4}+C
            &= \frac{1}{2}\arcsin x + \frac{2\sin t\cos t}{4}        \\
            &= \frac{1}{2}\arcsin x + \frac{x\sqrt{1-x^2}}{2} + c.
        \end{align*}
        Správně bychom měli místo \(\sqrt{1 - \sin^2x}\) psát \(\abs{\cos x}\). Vzhledem k tomu, že 
        jde o neurčitý integrál, je možné hledat primitivní funkci na intervalu, kde platí \(\cos x 
        = \abs{\cos x}\).
      \end{example}
      Jistě nám neuniklo, že princip substitučních metod I a II je stejný. Jsou totiž obě založeny 
      na použití pravidla pro derivaci složené funkce.
  
    % ---------Integrování součtu, úprava integrandu a integrování rozkladem------------------------
    \subsection{Integrování součtu, úprava integrandu a integrování rozkladem}
      \begin{example}
        Zdroj \cite[s.~29]{Knichal}.
        \begin{equation}\label{MA:int_ex_01}
          \int{\frac{x^4+3x^3-3x^2+3x}{x^2+1}\dd{x}}
        \end{equation}
        Dělením čitatele integrandu jmenovatelem  dostaneme rozklad integrandu na součet funkcí,
        jejich integrály najdeme snadno:
         \begin{equation*} 
           \polylongdiv[style=C,div=:]{x^4+3x^3-3x^2+3x}{x^2+1}
         \end{equation*}
         Tedy
         \begin{equation*}
           \frac{x^4+3x^3-3x^2+3x}{x^2+1} = x^2+3x-4+\frac{4}{x^2+1}  
         \end{equation*}
         Pro uvedený integrál dostaneme
         \begin{align*}
           \int{x^2}\dd{x} &+\int{3x}\dd{x}-4\int\dd{x}+\int{\frac{4}{x^2+1}\dd{x}} \\
                           &= \frac{x^3}{3}+\frac{3x^2}{2}-4x+4\arctan x + c.
         \end{align*}
      \end{example}
      
      \begin{example}
        Zdroj \cite[s.~29]{Knichal}.
        \begin{equation}\label{MA:int_ex_02}
          \int\frac{3}{(1+x^2)x^2}\dd{x}
        \end{equation}
        Integrand upravíme přičtením a odečtením výrazu $3x^2$ v čitateli zlomku takto:
        \begin{align*}
          \frac{3}{(1+x^2)x^2} 
            &= \frac{3+3x^2-3x^2}{(1+x^2)x^2} = \frac{3}{x^2}-\frac{3}{1+x^2}                      \\  
          \intertext{Tedy v každém otevřeném intervalu, který neobsahuje bod \(x=0\), platí}
          \int{\frac{3}{(1+x^2)x^2}\dd{x}} 
            &= 3\int{\frac{1}{x^2}dx} - 3\int{\frac{1}{1+x^2}dx}                                   \\
            &= -\frac{3}{x}-3\arctan x + c. 
        \end{align*}
      \end{example}
      
      \begin{example}
        Zdroj \cite[s.~30]{Knichal}.
        \begin{equation}\label{MA:int_ex_04}
          \int{\sqrt{1+\cos2x}\dd{x}}
        \end{equation}
        Funkci $\sqrt{1+\cos2x}$ upravíme na základě goniometrické identity \ref{MA1:eq_cos2x}:
        \(1+\cos2x = 1+\cos^2x-\sin^2x=2\cos^2x\) takto
        \begin{equation*}
          \sqrt{1+\cos2x} =\sqrt{2\cos^2x} = \sqrt{2}\abs{\cos x} = \varepsilon\sqrt{2}\cos x, 
        \end{equation*}
        \begin{equation*}
          \text{kde}\,\varepsilon =
            \begin{cases} 
             +1, &  x\in \left(-\frac{\pi}{2}+2n\pi,\frac{\pi}{2}+2n\pi\right), \\
             -1, &  x\in \left(\frac{\pi}{2}+2n\pi,\frac{3\pi}{2}+2n\pi\right),
            \end{cases}
        \end{equation*}
        $n$ je přirozené číslo. Proto pro $x$ ležící v uvedených intervalech je
        \begin{equation*}
          \int\sqrt{1+\cos2x}\dd{x} = \varepsilon\sqrt{2}\int\cos x\dd{x} 
                                 = \varepsilon\sqrt{2}\sin x + c.
        \end{equation*}
      \end{example}
      
      \begin{example}Zdroj \cite[s.~30]{Knichal}.
        \begin{equation}\label{MA:int_ex_05}
          \int\cos^2\frac{x}{2}\dd{x}
        \end{equation}
        Integrand upravíme na součet dvou tabulkových integrálů použitím vzorce
        \begin{align*}
          \cos^2\frac{x}{2} &= \frac{1}{2}(1+\cos x)     \\ 
          \shortintertext{takže}
          \int{\cos^2\frac{x}{2}}\dd{x} 
                            &= \frac{1}{2}\int{(1+\cos x)}\dd{x} = \frac{1}{2}(x+\sin x) + c.
        \end{align*}          
      \end{example}
      
      \begin{example}
        Zdroj \cite[s.~30]{Knichal}.
        \begin{equation}\label{MA:int_ex_06}
          \int{\tan^2x}\dd{x}
        \end{equation}
        funkci napíšeme ve tvaru 
        \begin{align*}
          \tan^2x &= \frac{\sin^2x}{\cos^2x}=\frac{1-\cos^2x}{\cos^2x} = \frac{1}{\cos^2x}-1   \\
          \shortintertext{takže}
          \int{\tan^2x}dx &= \int{\left(\frac{1}{\cos^2x}-1\right)}\dd{x} = \tan x - x + c.  
          \intertext{$\forall x\in\left(-\frac{\pi}{2}+k\pi, \frac{\pi}{2}+k\pi\right)$,
                     $k\in\naturalset$.}
        \end{align*}        
      \end{example}
      
      \begin{example}
        \begin{equation}\label{MA:int_ex_07} 
          \int\frac{\cos2x}{\cos^2x\cdot\sin^2x}\dd{x}, 
        \end{equation} 
        Je-li \(\sin^2x\cos^2x\neq0;\, x\neq k\frac{\pi}{2};\, k\in Z\).
        Integrand upravíme pomocí vzorce pro dvojnásobný úhel \ref{MA1:eq_cosx2}:
        \begin{align*}
          \int\frac{\cos^2x-\sin^2x}{\cos^2x\cdot\sin^2x}\dd{x} 
             &= \int\frac{1}{\sin^2x}\dd{x} -\int\frac{1}{\cos^2x}\dd{x}        \\
             &= -\cot x - \tan x + c. 
        \end{align*}
      \end{example}
      
      \begin{example}
       \begin{equation}\label{MA:int_ex_08}
         \int\frac{1}{\cos x\cdot\sin x}\dd{x}, 
       \end{equation}
       \((\sin x\cos x\neq0; x\neq k\frac{\pi}{2}; k\in Z)\).
       Integrand rozšíříme o funkci $\displaystyle{\frac{1}{\cos^2x}}$
        \begin{equation*}
          \bigintss\dfrac{\dfrac{1}{\cos^2x}}{\dfrac{\sin x\cdot\cos x}{\cos^2x}} \dd{x} = 
          \bigintss\dfrac{\dfrac{1}{\cos^2x}}{\tan x}\dd{x} = \ln\abs{\tan x} + C.
        \end{equation*}            
      \end{example}
  
    %--------------------------- Integrace racionální funkce--------------------------------------
    \subsection{Integrace racionální funkce}
      Některé příklady v předchozím odstavci, (viz např. \ref{MA:int_ex_01} a 
      \ref{MA:int_ex_02}) jsme dělením čitatele integrandu jmenovatelem dostali rozklad
      integrandu na součet racionální funkce (polynomu) a ryze lomené racionální funkce.
      Integrování polynomu je snadné, neboť jde o součet integrálů tvaru $\int c_kx^k dx$, kde
      $k$ je celé nezáporné číslo. Omezíme se tedy na integrování \emph{ryze lomené racionální
      funkce},  tj. funkce ve tvaru $P(x)/Q(x)$, kde $P(x), Q(x)$ jsou polynomy, přičemž stupeň
      polynomu $P(x)$ je menší než stupeň polynomu $Q(x)$. Taková funkce může vzniknout součtem
      několika jednoduchých zlomků.
      
      %-------------------------------------
      \input{../src/MAI/exam/exam116.tex}
      %-------------------------------------
      
      Jsme tedy vedeni myšlenkou, zda naopak každá ryze lomená racionální funkce se dá rozložit
      na součet jednoduchých zlomků určitého tvaru - budeme jim říkat \textbf{parciální zlomky},
      které umíme integrovat. Tím se budeme zabývat v dalších odstavcích. 
            
      \begin{example}
        \begin{equation}
          \int\frac{1}{x^2 - x + 1}\dd{x}, \qquad x\in R
        \end{equation}
        Kvadratický polynom ve jmenovateli upravíme na čtverec $f(x) = (x + m)^2 + n$:
        \begin{align*}
          \int\dfrac{1}{\left(x-\dfrac{1}{2}\right)^2+\dfrac{3}{4}}\dd{x}   &=
            \dfrac{1}{\sqrt{1-\left(\dfrac{1}{2}\right)^2}}\arctan
            \dfrac{x-\dfrac{1}{2}}{\sqrt{1-\left(\dfrac{1}{2}\right)^2}}                       \\
          \dfrac{2}{\sqrt{3}}\arctan\dfrac{2x-1}{\sqrt{3}}               &=
            \dfrac{2\sqrt{3}}{3}\arctan\dfrac{\sqrt{3}(2x-1)}{3} + C
        \end{align*}
      \end{example}     
      
      \begin{definition} Parciální (částečným) zlomkem, budeme nazývat zlomek tvaru
         \begin{equation}
            \frac{A}{(x-\alpha)^k} \qquad\text{nebo}\qquad\frac{Mx + N}{x^2 + px +q}
         \end{equation}  
         $A,\ M,\ N,\ \alpha\ , p,\ q$ reálné $p^2-4q < 0$, $k$ celé nezáporné.         
      \end{definition}
      
      Integrál prvního zlomku, tj. $\displaystyle{\int\frac{A}{(x-\alpha)^k}\dd{x}}$, vypočteme 
      substitucí $x-\alpha=t$, odtud plyne $dx = dt$,
      \begin{equation}\label{MA:int_ex_14}
        \int\frac{A}{(x-\alpha)^k}dx = \int\frac{A}{t^k}dt.
      \end{equation}
      Tento integrál se rovná
      \begin{equation}\label{MA:int_ex_16}
        -\frac{A}{k-1}\frac{1}{(x-\alpha)^{k-1}} + C.
      \end{equation}        
      je-li $k>1$, a rovná se $A\ln\abs{x-\alpha} + C$, je-li $k = 1$. Výsledek platí na každém
      intervalu neobsahujícím bod $\alpha$.
      
       U integrál druhého zlomku uvedeme postup výpočtu pro $k = 1$. 
      \begin{align*}
         \intertext{\(\displaystyle\int{\frac{Mx + N}{x^2+px+q}dx}\)}
           \quad &=  \int{\frac{Mx}{x^2+px+q}dx} + \int{\frac{N}{x^2+px+q}dx}                     
           \\  
           \quad &=  \frac{M}{2}\int{\frac{(2x + p) - p}{x^2+px+q}dx} + 
                     N\int{\frac{1}{x^2+px+q}dx}                                                   \\ 
           \quad &=  \frac{M}{2}\int{\frac{2x + p}{x^2+px+q}dx} + 
                      \left(N-\frac{Mp}{2}\right)\int{\frac{1}{x^2+px+q}dx.}                   
      \end{align*}  
      
      Z naznačeného postupu je vidět hlavní myšlenka: upravit integrál na lineární kombinaci dvou 
      integrálů, z nichž první má v čitateli integrandu derivaci jmenovatele a je podle příkladu 
      *** roven $\ln\abs{x^2+px+q}$ kde $x^2+px+q >0$ pro $x\in R$ a integrand druhého integrálu má 
      čitatel konstantní.
      
      Výpočet druhého integrálu probíhá takto: 
      \begin{equation}\label{MA:int_ex_10}
        \int\dfrac{1}{x^2+px+q}\dd{x} = 
          \int\dfrac{1}{\left(x+\dfrac{p}{2}\right)^2 + q - \dfrac{p^2}{4}}\dd{x};
      \end{equation}
      substitucí $x+\dfrac{p}{2} = t\sqrt{q - \dfrac{p^2}{4}}$ dostáváme dále
      \begin{equation*}\label{MA:int_ex_11}
        \bigints{\frac{1}{\displaystyle{\left(x+\frac{p}{2}\right)^2 + q - \frac{p^2}{4}}}}dx 
          =\displaystyle{
            \bigints{
              \frac{\sqrt{q-\frac{p^2}{4}}}{\left(q-\frac{p^2}{4}\right)(t^2+1)}}dt
            }   
      \end{equation*}
      po úpravě dostaneme tabulkový integrál
      \begin{equation}\label{MA:int_ex_12}
        \frac{1}{\sqrt{q-\frac{p^2}{4}}}\int{\frac{dt}{t^2+1}},
      \end{equation}
      jehož řešení je  
      \begin{equation*}\label{MA:int_ex_13}
        \frac{1}{\sqrt{q-\frac{p^2}{4}}}\arctan{t} 
          = \sqrt{q-\frac{p^2}{4}}\arctan\frac{x+\frac{p}{2}}{\sqrt{q-\frac{p^2}{4}}}.     
      \end{equation*}   
      Z postupu je opět vidět hlavní myšlenka: úprava integrandu na tvar $\frac{1}{t^2+1}$.
      Jmenovatel $x^2+px+q$ jsme doplnili na úplný čtverec a užili uvedenou substituci (uvažme,
      že $q-\frac{p^2}{4}>0$, protože diskriminant $\frac{p^2}{4}-q$ trojčlenu $x^2+px+q$ je
      podle předpokladu záporný). Výsledek platí u obou integrálu v intervalu \((-\infty,
      +\infty)\).
      
      % -----------------------Funkce typu {f(x)=\sqrt{ax+b}} ------------------------------------
      \subsubsection*{Funkce typu $\boxed{f(x)=\sqrt{ax+b}}$ :}
         Funkci, jež je dána rovnicí, jež obsahuje polynomy proměnné x  ve výrazu $\sqrt{ax+b}$,
         v němž $ax+b>0$, $a>0$, integrujeme pomocí substituce:
         \begin{equation}\label{ma:eq_sub_fce1}
             u=\sqrt{ax+b},\quad du=\frac{1}{2}\frac{a}{u}dx,\quad dx=2\frac{u}{a}du
         \end{equation}
         Je-li potřeba dosadit do integrované funkce také za $x$, vyjádříme ze substituční
         rovnice $x=\frac{u^2-b}{a}$.
      % ----------------------Funkce typuf(x)=\frac{1}{\sqrt{x^2+a}}, a\neq0 -------------------- 
      \subsubsection*{Funkce typu $\boxed{f(x)=\frac{1}{\sqrt{x^2+a}}}, a\neq0$ :}
         \begin{example}\label{ma:ex_sub_metoda1}
           \(\int\frac{1}{\sqrt{x^2+a}}\dd{x}\):\vskip0.5mm
           Užijeme \textbf{Eulerovu substituci}: \(u=x+\sqrt{x^2+a}\), a dostáváme
           \(du=\frac{u}{\sqrt{x^2+a}}dx\), \(\frac{du}{u}=\frac{dx}{\sqrt{x^2+a}}\).
           \begin{equation*}
             \int{\frac{1}{\sqrt{x^2+a}}dx}=\int{\frac{du}{u}}=\ln\abs{u}
                                           =\ln\left\lvert x+\sqrt{x^2+a}\right\rvert+C
           \end{equation*}
         \end{example}
  
    % --------------------------Integrály goniometrických funkcí------------------------------------
    \subsubsection{Integrace goniometrických funkcí}
      
    % ---------------- Rozklad ryze lomené funkce v parciální zlomky -------------------------------
    \subsubsection{Rozklad ryze lomené funkce v parciální zlomky}
      Nechť je dána racionální funkce $R = \frac{P}{Q}$ s reálnými koeficienty. Můžeme
      předpokládat, že je \emph{ryze lomená}\footnote{tj. stupeň polynomu $P$ je menší než
      stupeň polynomu $Q$}. Pokud by tomu tak nebylo, dostaneme dělením čitatele jmenovatelem
      zlomku součet polynomu a ryze lomené racionální funkce.
      
      \begin{example}$\displaystyle\int{\frac{8x-31}{x^2-9x+14}}dx$\cite[s.~90]{Knichal}\newline
        Kořeny polynomu ve jmenovateli $\alpha_1 = 2$, $\alpha_2 = 7$ jsou jednoduché - každému z
        nich bude v rozkladu odpovídat jen jeden člen $$\frac{8x-31}{x^2-9x+14} = \frac{A}{x-2}
        + \frac{B}{x-7}.$$ Členy mnohočlenu na pravé straně seřadíme podle mocnin $x$ $$8x-31 =
         x(A+B)+(7A-2B).$$ Porovnáním odpovídajících si koeficientů dostaneme
        \begin{align*}
          8   &=   \; A + \, B \\
          -31 &= -7A - 2B
        \end{align*}
        Řešením této soustavy je $A = 3, B = 5$. Platí tedy (pro všechna $x \neq 2$ a $x \neq 7$)
        $$\frac{8x-31}{x^2-9x+14} = \frac{3}{x-2} + \frac{5}{x-7}.$$
        \begin{align*}
          \int{\frac{8x-31}{x^2-9x+14}}dx 
            &= \int{\frac{3}{x-2}}dx + \int{\frac{5}{x-7}}dx      \\
            &= 3\ln\abs{x-2} + 3\ln\abs{x-7} + C.
        \end{align*}
        Výsledek platí v každém intervalu, který neobsahuje body \(x = 2\), \(x = 7\).
      \end{example}
      
      \begin{example}\label{MA:eq_ex1}$\displaystyle\int{\frac{19x+15}{x^2-x-2}}dx \qquad 
      x\in
        R-\{1,2\} $ \newline Kořeny polynomu ve jmenovateli $\alpha_1 = -1$, $\alpha_2 = 2$ jsou
        jednoduché - každému z nich bude v rozkladu odpovídat jen jeden člen: 
        \begin{align*}
          \frac{19x+15}{x^2-x-2}     &= \frac{A}{x+1} + \frac{B}{x-2} \\
                           19x +15   &= A(x-2) + B(x+1)               \\
                           19x +15   &= x(A+B) - 2A + B               \\
                           19        &= A + B                         \\
                                15   &=        - 2A + B
        \end{align*}              
        Řešením této soustavy je $A = \frac{4}{3}$, $B = \frac{53}{3}$.
        \begin{equation*}
          = \frac{4}{3}\int{\frac{1}{x+1}}dx+\frac{53}{3}\int{\frac{1}{x-2}}dx 
          = \frac{4}{3}\ln\abs{x+1} - \frac{53}{3}\ln\abs{x-2} +  C
        \end{equation*}      
      \end{example}
      
      %-------------------------------------
      \input{../src/MAI/exam/exam115.tex}
      %-------------------------------------

  % ---------------- Sbírka řešených příkladů ------------------------------------------------------
  \section{Sbírka řešených příkladů}
    Hledejme primitivní funkce \(F(x)\) k následujícím funkcím
    \input{../src/MAI/exam/exam112.tex}
    \input{../src/MAI/exam/exam113.tex}
    \input{../src/MAI/exam/exam114.tex}
    \input{../src/MAI/exam/exam016.tex}
%---------------------------------------------------------------------------------------------------