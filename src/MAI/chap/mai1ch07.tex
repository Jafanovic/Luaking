% !TeX spellcheck = cs_CZ
%---------------------------------------------------------------------------------------------------
% file: mai1ch07.tex
%---------------------------------------------------------------------------------------------------
%============================ Primitivní funkce ====================================================
\setchaptertoc
\chapter{Poznáváme funkci z její derivace - neurčitý integrál}
  %----------------------------Neurčitý integrál----------------------------------------------------
  \section{Motivace}
    Problém \emph{neurčitého integrálu}, neboli \textbf{primitivní funkce}, lze vyložit velmi 
    jednoduše: Máme podezření, že zadaná funkce \(f(x)\) vznikla derivováním jisté, zatím neznámé, 
    funkce \(F(x)\). Dokážeme ji najít? 
  
    K danému problému můžeme přistupovat také fyzikálně: Zavedením pojmu derivace funkce jsme 
    motivovali důležitým požadavkem definovat okamžitou rychlost pohybu bodu po přímce. Existuje 
    přirozeně i požadavek opačný, tj. nalézt zákon dráhy pohybu bodu po přímce, je-li dána jeho 
    okamžitá rychlost jako funkce času \cite[s.~253]{Brabec1989}. Vše si ukážeme na následujícím 
    příkladu:      
    %-------------------------------------
    \input{../src/MAI/exam/exam117.tex}
    %-------------------------------------
    Každé takové funkci, jejíž derivací je daná funkce, budeme říkat \emph{primitivní funkce} k 
    dané funkci. Na uvedeném příkladě je patrné, že k dané funkci může existovat nekonečně mnoho 
    primitivních funkcí. Množinu všech primitivních funkcí se často nazývá \textbf{neurčitým 
    integrálem}. Po tomto názorném uvedení do problému přejděme k přesné formulaci základních pojmů.
    
  \section{Definice primitivní funkce}  
    \begin{mdframed}[style=mdmathdef] 
      \begin{definition}\label{mai:def002}
        Funkci \(F(x): J\rightarrow \realset\), kde \(J\subset \realset\) je interval, nazveme
        \textbf{primitivní} funkcí k funkci \(f(x)\) na intervalu \(J\) právě když, pro všechna
        \(x\in J\) je \(F'(x) = f(x)\). 
        
        V případě uzavřeného intervalu \(J=[a,b]\) požadujeme ještě, aby obě jednostranné derivace
        splňovali \(F_+'(a)=f(a)\) a \(F_-'(b)=f(b)\). 
        
        Množina všech primitivních funkcí k funkci \(f(x)\) na \(J\) se nazývá \textbf{neurčitý
        integrál} z funkce \(f(x)\) a značí se \(\int f(x)\dd{x}\). Tedy
        \begin{gather}\label{mai:eq101}
          \int f(x)\dd{x} = \{F(x): \text{\(F(x)\) je primitivní funkcí k \(f(x)\) na \(J\)}\}
        \end{gather}
      \end{definition}
    \end{mdframed}
    %-------------------------------------
    \input{../src/MAI/exam/exam118.tex}
    %-------------------------------------
    
    Z uvedených příkladů je vidět, že rozdíl dvou primitivních funkcí k téže funkci je konstanta. To
    není náhoda, jak potvrzuje následující věta:

    \begin{mdframed}[style=mdmathlemma] 
      \begin{lemma}\label{mai:lemma008}(Věta o rozdílu dvou primitivních funkcí)
        \begin{enumerate}[noitemsep]
          \item Je-li funkce $F$ primitivní funkcí k funkci \(f\) na intervalu \(J\) a \(c\) reálná  
                konstanta, pak i funkce $G = F + c$ je primitivní funkcí k funkci \(f\) na intervalu 
                \(J\).
          \item Jsou-li funkce $F$ a $G$ primitivní funkce k funkci \(f\) na intervalu \(J\), pak 
          funkce
                $F-G$ je na intervalu \(J\) konstantní.
        \end{enumerate} 
        \begin{proof}
          Tvrzení a) plyne z definice protože $G'(x) = [F(x) + c] = F'(x) = f(x)$ pro všechna $x\in
          J$. Tvrzení b) je důsledkem věty \ref{MA1:lem_diff01}.
        \end{proof}
      \end{lemma}
    \end{mdframed}

    \subsection{Poznámky k definici}  
      Z definice \ref{mai:def002} vyplývá, že primitivní funkce je spojitou funkcí, neboť má
      derivaci a věta \ref{mai:lemma008} nám říká, že pokud k dané funkci existuje funkce
      primitivní, existuje jich nekonečně mnoho. Je-li např. \(F\) primitivn9 funkce k funkci \(f\)
      na intervalu \(J\), pak množina všech primitivních funkcí je množina \(\{F + c;
      c\in\realset\}\). Tuto množinu označujeme symbolem \(\int f(x)\dd{x}\) a čteme \uv{integrál
      \(f(x)\dd{x})\)} Symbolu \(\int f(x)\dd{x}\) říkáme \textbf{neurčitý integrál}. Zpravidla
      píšeme
      \begin{mdframed}[style=mdmathlemma]  
        \begin{equation}\label{mai:eq102}
          \int f(x)\dd{x} = F(x) + c
        \end{equation}
      \end{mdframed}
      nebo jen \(\int f(x)\dd{x} = F(x)\) (tj. aditivní konstantu vynecháváme) a máme tím na mysli
      že \(F(x) \in \int f(x)\dd{x}\). Rovnost \ref{mai:eq102} je tedy rovnost mezi množinami,
      nikoliv rovnost funkcí. 
    
    \subsection{Některé vlastnosti integrálů}  
      Platnost několika následujících vztahů lze prověřit přímo užitím deﬁnic derivace a neurčitého
      integrálu. Tyto vztahy jsou při výpočtech často používány. Nejprve však uvedeme základní
      pravidla pro primitivní funkce, která plynou z pravidel pro derivování:
      \begin{subequations}
        \begin{flalign}
          \int\dd{f(x)} &= f(x) + c,                                          &\label{mai:eq134} \\
          \dxd\left[\int f(x)\dd{x}\right] &= f(x)\dd{x},                     &\label{mai:eq135} \\
          \int[f(x)\pm g(x)]\dd{x}&= \int f(x)\dd{x} + \int g(x)\dd{x},       &\label{mai:eq103} \\
          \int kf(x)\dd{x}      &=k\int f(x)\dd{x},\quad\text{\(k=\) konst.}, &\label{mai:eq104} \\
          \left[\int f(x)\dd{x}\right]' &= f(x),                              &\label{mai:eq136}
        \end{flalign}
      \end{subequations}
  
  \section{Tabulka neurčitých integrálů}\label{MA:chap_tabINT}
    Jak ale primitivní funkce hledat? V jednoduchých příkladech poslouží tabulka derivací, již čteme
    „zprava doleva“. (Je dobré si ji uložit do paměti.) Tabulka však pokryje jen velmi málo případů,
    pouze elementární funkce. Je tedy třeba najít metody, jak při hledání primitivních funkcí
    postupovat.

    Uveďme nyní některé základní integrály. Poznamenejme, že touto tabulkou nejsou zdaleka vyčerpány
    všechny funkce, ke kterým umíme primitivní funkce najít. Existují celé knihy obsahující tabulky
    integrálů a programy výrazně ulehčující hledání primitivních funkcí. Literatura:
    \cite{Rektorys1963}, \cite{Brabec1989}, \cite{diblik2002}. 

    Pokud není nic uvedeno, platí vzorce pro všechna \(x\) a pro všechny hodnoty uvedených konstant.
    Místo platí pro \(x\) z intervalu \((-\infty,0),(0,+\infty)\) píšeme stručně \(x\neq0\) apod.
    Obory platnosti uvádíme jen tam, kde nejsou evidentní.  

    \begin{flalign}
      \midrule
      & \int 0\dd{x} = c                                        &      \label{mai:eq105}     \\
      & \int a\dd{x} = ax+c                                     &      \label{mai:eq106}     \\
      & \int x^n\dd{x} = \frac{x^{n+1}}{n+1}+c,                 &      \label{mai:eq107}     \\              
        \shortintertext{\hspace{2em} kde \(\begin{cases}
          \forall x\in\realset,\,n\in\naturalset, n>0,         \\
          \forall x\in\realset-\{0\},\,n\in\naturalset, n<-1,  \\
          \forall x>0,\,n\in\realset\,\,n\neq-1
        \end{cases}\)}                                          
      & \int\frac{1}{x}\dd{x} = 
            \ln\abs{x}+c \hspace{1ex}\forall x\neq0            &       \label{mai:eq108}    \\
      & \int e^x \dd{x}       = e^x+c                          &       \label{mai:eq109}    \\
      & \int\ln x\dd{x}       = 
          x\ln x - x + c \hspace{1ex}\forall x>0               &       \label{mai:eq110}    \\
      & \int a^x \dd{x}     =
        \frac{a^x}{\ln a}+c 
        \hspace{1ex}\forall a>0,\,a\neq1                       &       \label{mai:eq111}    \\
      & \int \sin x \dd{x}  = -\cos x                          &       \label{mai:eq112}    \\
      & \int \cos x \dd{x}  =  \sin x                          &       \label{mai:eq113}    \\
      & \int\frac{1}{\cos^2x}\dd{x} =  \tan x + c              &       \label{mai:eq114}    \\
        \shortintertext{\(\hspace{2em}\forall x\neq\frac{1}{2}\pi+k\pi,\,k\in\naturalset\)}\nonumber\\       
      & \int\frac{1}{\sin^2x}\dd{x}     =  -\cotg x+c         &        \label{mai:eq115}    \\
        \shortintertext{\(\hspace{1em}\forall x\neq k\pi,\,k\in\naturalset\)}
      & \int\frac{1}{\sqrt{1-x^2}}\dd{x} =
          \begin{cases}
            +\arcsin x + c         \\
            -\arccos x + c
          \end{cases}                                          &      \label{mai:eq116}    \\
        \shortintertext{\(\hspace{2em}\forall x\in(-1,1) \)}  
    & \int\sinh x\dd{x} = \cosh x + c                         &       \label{mai:eq117}    \\
    & \int\dfrac{1}{\sinh x}\dd{x} = -\cotgh x + c            &       \label{mai:eq118}    \\
    & \int\cosh x\dd{x} = \sinh x + c                         &       \label{mai:eq119}    \\
    & \int\dfrac{1}{\cosh x}\dd{x} = -\tanh x + c             &       \label{mai:eq120}    \\
    & \int\frac{1}{1+x^2}\dd{x} = \arctan x + c               &       \label{mai:eq121}    \\
    & \int\frac{1}{\sqrt{x^2 + 1}}\dd{x} =
        \begin{cases}
            \ln(x + \sqrt{x^2+1}) + c         \\
            \argsinh x            + c 
        \end{cases}                                           &       \label{mai:eq122}    \\ 
    & \int \frac{1}{\sqrt{x^2 - 1}}\dd{x} =
        \begin{cases}
            \ln(x + \sqrt{x^2-1}) + c         \\
            \argcosh x            + c  
        \end{cases}                                           &       \label{mai:eq123}    \\   
      \shortintertext{\hspace{2em}\(x\in(1,+\infty)\)}  
    & \int\frac{1}{\sqrt{x^2+a^2}}\dd{x} 
        = \begin{cases}
              \argsinh\frac{x}{a}   + c  \\ 
              \ln(x+\sqrt{x^2+a^2}) + c     
          \end{cases}                                          &      \label{mai:eq124}    \\
    & \int \frac{1}{\sqrt{x^2-a^2}}\dd{x} 
        = \begin{cases}
              \argcosh\frac{x}{a}   + c   \\
              \ln(x+\sqrt{x^2-a^2}) + c
          \end{cases}                                          &      \label{mai:eq125}    \\
    & \int\tan x \dd{x}   = \ln\abs{\sec x} + c                &      \label{mai:eq126}    \\
    & \int\sec x \dd{x}   = \ln\abs{\sec x + \tan x} + c       &      \label{mai:eq127}    \\
    & \int\sec^2 x \dd{x} = \tan x + c                         &      \label{mai:eq128}    \\
    & \int\sec x\tan x \dd{x} = \sec x + c                     &      \label{mai:eq129}    \\
    & \int\frac{a}{a^2+x^2}\dd{x} = \tan^{-1}\frac{x}{a} + c   &      \label{mai:eq130}    \\
    & \int\frac{a}{a^2-x^2}\dd{x} = 
      \frac{1}{2}\ln\left\lvert\frac{x+a}{x-a}\right\rvert     &      \label{mai:eq131}    \\
    & \int\frac{1}{\sqrt{a^2-x^2}} \dd{x} = 
      \sin^{-1} \frac{x}{a}                                    &      \label{mai:eq132}    \\
    & \int\frac{a}{x\sqrt{x^2-a^2}}\dd{x} = 
      \sec^{-1} \frac{x}{a}                                    &      \label{mai:eq133}     
    \end{flalign}

    \begin{mdframed}[style=mdnote]
      \begin{note}  
        \(\argsinh x\), \(\argcosh x\), \(\argtanh x\), \(\argcoth x\) jsou funkce inverzní k
        hyperbolickým funkcím. Značení těchto funkcí není jednotné. Správné zkratky jsou ty, které
        specifikuje norma \texttt{ISO 80000-2}. Skládají se z \uv{ar} následovaných zkratkou
        odpovídající hyperbolické funkce (např. arsinh, arcosh).

        Nicméně, předpona \uv{arc} - následovaná odpovídající hyperbolickou funkcí (např. arcsinh,
        arccosh) je také běžně vidět, analogicky s nomenklaturou pro inverzní trigonometrické
        funkce. Není to však správné pojmenování, protože prefix \uv{arc} je zkratka pro
        \textbf{arcus}, zatímco prefix \uv{ar} znamená \textbf{area}. 

        Autoři jako prof. K. Rektorys upřednostňují použití označení \(\argsinh\), \(\argcosh\),
        \(\argtanh\) atd., kde předpona \uv{arg} je zkratkou latinského \textbf{argumentu}. V
        počítačové vědě se to často zkracuje na asinh.

        Používá se také zápis \(\sinh^{-1}(x)\), \(\cosh^{-1}(x)\) atd., a to navzdory skutečnosti,
        že je třeba dbát na to, aby nedošlo k nesprávným interpretacím horního indexu \(-1\) jako
        mocniny, na rozdíl od zkratky pro označení inverzní funkce (např.\(\cosh^{-1}(x)\) versus
        \(\cosh(x)^{-1}\)).
      \end{note}
    \end{mdframed}

    \begin{mdframed}[style=mdnote]
      \begin{note}  
        Třebaže ke každé spojité funkci existuje primitivní funkce, nelze v mnoha případech tuto
        primitivní funkci vyjádřit pomocí elementárních funkcí. Příkladem takové funkce je funkce
        \(e^{x^2}\). integrálem
        \begin{equation*}
          \int e^{x^2}\dd{x}
        \end{equation*}
        je tedy definována nová transendentní funkce. Podobně jsou nové transendentní funkce
        definovány integrály
        \begin{align*}
          \text{Si }x &= \int_0^x     \frac{\sin t}{t}\dd{t},&&\ldots\text{integrálsinus}     \\
          \text{Ci }x &=-\int_x^\infty\frac{\cos t}{t}\dd{t},&&\ldots\text{integrálcosinus}   \\
          \text{Li }x &= \int_0^x     \frac{\dd{t}}{\ln t},  &&\ldots\text{logaritmusintegrál}\\
          \text{Ei }x &= \int_{-\infty}^x \frac{e^t}{t}\dd{t}&&   
        \end{align*}

      \end{note}
    \end{mdframed}

  \twocolumn[\section{Metody určení primitivní funkce}]
    Procesu hledání primitivní funkce se často říká integrování nebo integrace (od slova“integrál”),
    což z matematického hlediska znamená provést inverzní operaci k operaci derivování. Smutnou
    zprávou je, že na rozdíl od derivování neexistuje obecný vzorec pro integrování součinu či
    podílu, ani obecný vzorec pro integrování složených funkcí. Při hledání integrálů složitějších
    funkcí se využívá např. \emph{linearita, metoda per partes, substituční metoda}, popř. některé
    další speciální metody. Řešitel v mnoha případech musí projevit důvtip a intuici, která mu
    pomůže nalézt primitivní funkci k dané funkci.
  
    % --------------------------Integrace po částech - per partes-----------------------------------
    \subsection{Integrace po částech - per partes}
      Metoda integrace \emph{per partes} neboli \emph{po částech} využívá vzorce pro derivaci 
      součinu funkcí. Připomeňme si jej: Pro derivaci součinu dvou funkcí \(u(x)\) a \(u(x)\) platí
      \cite[p.~137]{Musilova2009MA1}.
      \begin{equation}\label{MA:eq_Int29}
        [u(x)v(x)]' = u(x)'v(x) + u(x)v'(x).
      \end{equation} 
      Primitivní funkcí levé strany je \(F(x) = u(x)v(x)\), a tedy
      \begin{equation*}
        u(x)v(x) =  \int u'(x)v(x)\dd{x} + \int u(x)v'(x)\dd{x}
      \end{equation*}  
      za předpokladu, že existují obě primitivní funkce na pravé straně. K čemu může tento
      samozřejmý vzorec sloužit při hledání primitivní funkce? Dejme tomu, že zadaná funkce
      \(f(x)\), k níž máme hledat funkci primitivní, je tvaru \(f(x) = u'(x)v(x)\), a my si s ní
      nevíme rady. Je však možné, že bychom si docela dobře poradili s primitivní funkcí k funkci
      \(g(x) = u(x)v(x)\). A předchozí vzorec umožňuje nahradit výpočet neurčitého integrálu z
      funkce \(f(x)\) výpočtem neurčitého integrálu z funkce \(g(x)\), tedy
      \begin{equation}\label{ma:eq_perpartes}
        \int u'(x)v(x)\dd{x} = u(x)v(x) - \int u(x)v'(x)\dd{x} 
      \end{equation}

      %-------------------------------------
      \input{../src/MAI/exam/exam111.tex}
      %-------------------------------------

      Není vždy jednoduché rozpoznat, jak máme rozložit funkci \(f(x)\) na součin funkcí \(u'(x)\) 
      a \(v(x)\). Takový rozklad není určen jednoznačně a požadavek na něj bychom mohli (dosti 
      nepřesně) formulovat tak, aby funkce \(v'(x)\) byla jednodušší než v \(v(x)\) (například 
      derivováním polynomu se snižuje jeho stupeň) a funkce \(u'(x)\) a \(u(x)\) aby byly zhruba 
      „stejně složité“ (například \(u'(x) =e^x\), \(u(x) = e^x\), nebo \(u'(x) = \cos x\), \(u(x) = 
      \sin x\), apod.). Spolehlivě používat metodu per partes se však můžeme naučit pouze studiem 
      vyřešených příkladů z literatury a praktickým procvičováním \cite[p.~138]{Musilova2009MA1}.
  
      %-------------------------------------
      \input{../src/MAI/exam/exam109.tex}
      %-------------------------------------
  
    %--------------------------- Substituční metoda ----------------------------------------------
    \subsection{Substituční metoda I}
      Tato metoda \emph{substituce} neboli \emph{náhrady} spočívá v tom, že vhodně zvolenou funkci
      obsaženou v předpisu \(f(x)\) označíme jako novou jednoduchou proměnnou. Čeho tím dosáhneme?
      Předpokládejme například, že \[f(x)=\varphi'(x)g[\varphi(x)]\] a označme jako novou proměnnou
      \(u = f(x)\). Že to vypadá, jako bychom se chystali použít vzorec pro derivaci složené funkce?
      Správně! Dejme tomu, že známe primitivní funkci \(G(u)\) k funkci \(g(u)\). Pak platí
      \begin{equation*}
        \left[G\left(\varphi(x)\right)\right]' = G'\left[\varphi(x)\right]\cdot\varphi'(x) 
        = g\left[\varphi(x)\right]\cdot\varphi'(x),     
      \end{equation*}
      a tedy
      \begin{equation*}
        \int \varphi'(x) g\left[\varphi(x)\right]\dd{x} =  G\left[\varphi(x)\right]. 
      \end{equation*}      
      Na základě těchto úvah formulujeme následující větu (viz. \cite[p.~142]{diblik2002}):
      \begin{mdframed}[style=mdmathlemma]
        \begin{lemma}\label{mai:lemma009}
          Jestliže
          \begin{equation}\label{ma:eq_subst1}
            \int{f(u)\dd{u}}=F(u)+c
          \end{equation}
          a $u=\varphi(x)$, pak
          \begin{equation}\label{ma:eq_subst2}
              \int{f[\varphi(x)]\varphi'(x)\dd{u}}=F(\varphi(x))+c
          \end{equation}
        \end{lemma}
      \end{mdframed}
  
      Základem úspěchu při aplikací věty je správný výběr funkce $\varphi(x)$. Praxe je totiž
      taková, že výpočet konkrétních příkladů je schématicky veden od rov. \ref{ma:eq_subst2} ke
      vzorci rov. \ref{ma:eq_subst1}.

      %-------------------------------------
      \input{../src/MAI/exam/exam110.tex}
      %-------------------------------------

      %-------------------------------------
      \input{../src/MAI/exam/exam124.tex}
      %-------------------------------------

      %-------------------------------------
      \input{../src/MAI/exam/exam125.tex}
      %-------------------------------------      

      %-------------------------------------
      \input{../src/MAI/exam/exam126.tex}
      %------------------------------------- 

      %-------------------------------------
      \input{../src/MAI/exam/exam119.tex}
      %-------------------------------------

      Ukažme, že platí 
      \begin{equation}\label{mai:eq139}
        \boxed{\int{\dfrac{f'(x)}{f(x)}}\dd{x} = \ln\abs{f(x)} + c.}
      \end{equation}
      Zavedeme substituci \(f(x) =t\), pak \(f'(x)\dd{x} = \dd{t}\) a 
      \begin{equation*}
        \int{\dfrac{\dd{t}}{t}} = \ln\abs{t} + c = \ln\abs{f(x)} + c
      \end{equation*}
      na každém intervalu, v němž \(f(x)\neq 0\) a existuje \(f'\). Připomeňme, že výraz
      \(\dfrac{f'(x)}{f(x)}\) se nazývá \emph{logaritmická derivace funkce} \(f\). Viz příklad
      \ref{mai:exam123}.
   

    % -------------------Substituční metoda II------------------------------------------------------
    \newpage
    \subsection{Substituční metoda II}
      Druhý typ substituční metody spočívá naopak v tom, že na místo původní proměnné \(x\) 
      dosadíme vhodnou funkci \(x = \psi(t)\). Místo primitivní funkce k funkci \(f(x)\) pak 
      hledáme primitivní funkci k funkci \(g(t) = f[\psi(t)]\psi'(t)\). Skutečně, je-li \(F(x)\) 
      primitivní funkcí k \(f(x)\), pak derivací složené funkce \(G(t) = F[\psi(t)]\) dostaneme
      \begin{equation*}
       G'(t) = F'[\psi(t)]\psi'(t) = f[\psi(t)]\psi'(t) = g(t).
      \end{equation*}

      %-------------------------------------
      \input{../src/MAI/exam/exam122.tex}
      %-------------------------------------

      Jistě nám neuniklo, že princip substitučních metod I a II je stejný. Jsou totiž obě založeny 
      na použití pravidla pro derivaci složené funkce.
  
    % ---------Integrování součtu, úprava integrandu a integrování rozkladem------------------------
    \twocolumn[\subsection{Integrování součtu, úprava integrandu a integrování rozkladem}]
      %-------------------------------------
      \input{../src/MAI/exam/exam121.tex}
      %-------------------------------------

      %-------------------------------------
      \input{../src/MAI/exam/exam130.tex}
      %-------------------------------------

      %-------------------------------------
      \input{../src/MAI/exam/exam131.tex}
      %-------------------------------------      

      %-------------------------------------
      \input{../src/MAI/exam/exam132.tex}
      %-------------------------------------  
     
      %-------------------------------------
      \input{../src/MAI/exam/exam127.tex}
      %-------------------------------------

      %-------------------------------------
      \input{../src/MAI/exam/exam133.tex}
      %-------------------------------------  

      %-------------------------------------
      \input{../src/MAI/exam/exam134.tex}
      %------------------------------------- 
  
    %--------------------------- Integrace racionální funkce--------------------------------------
    \newpage
    \subsection{Integrace racionální funkce}
      Některé příklady v předchozím odstavci, (viz např. \ref{MA:int_ex_01} a 
      \ref{MA:int_ex_02}) jsme dělením čitatele integrandu jmenovatelem dostali rozklad
      integrandu na součet racionální funkce (polynomu) a ryze lomené racionální funkce.
      Integrování polynomu je snadné, neboť jde o součet integrálů tvaru $\int c_kx^k dx$, kde
      $k$ je celé nezáporné číslo. Omezíme se tedy na integrování \emph{ryze lomené racionální
      funkce},  tj. funkce ve tvaru $P(x)/Q(x)$, kde $P(x), Q(x)$ jsou polynomy, přičemž stupeň
      polynomu $P(x)$ je menší než stupeň polynomu $Q(x)$. Taková funkce může vzniknout součtem
      několika jednoduchých zlomků (viz. následující příklad \ref{MAI:exam116}).
      
      %-------------------------------------
      \input{../src/MAI/exam/exam116.tex}
      %-------------------------------------
      
      Jsme tedy vedeni myšlenkou, zda naopak každá ryze lomená racionální funkce se dá rozložit
      na součet jednoduchých zlomků určitého tvaru - budeme jim říkat \textbf{parciální zlomky},
      které umíme integrovat. Tím se budeme zabývat v dalších odstavcích. 
    
      %-------------------------------------
      \input{../src/MAI/exam/exam120.tex}
      %-------------------------------------
      
      \begin{mdframed}[style=mdmathdef] 
        \begin{definition} Parciální (částečným) zlomkem, budeme nazývat zlomek tvaru
          \begin{equation}
              \frac{A}{(x-\alpha)^k} \qquad\text{nebo}\qquad\frac{Mx + N}{x^2 + px +q}
          \end{equation}  
          $A,\ M,\ N,\ \alpha\ , p,\ q$ reálné $p^2-4q < 0$, $k$ celé nezáporné.         
        \end{definition}
      \end{mdframed}    
      
      Integrál prvního zlomku, vypočteme substitucí $x-\alpha=t$, odtud plyne \(\dd{x} = \dd{t}\),
      \begin{equation}\label{MA:int_ex_14}
        \boxed{\int\frac{A}{(x-\alpha)^k}dx = \int\frac{A}{t^k}dt.}
      \end{equation}
      Tento integrál se rovná
      \begin{equation}\label{MA:int_ex_16}
        -\frac{A}{k-1}\frac{1}{(x-\alpha)^{k-1}} + C, \quad k\neq1.
      \end{equation}  
      a 
      \begin{equation}
        A\ln\abs{x-\alpha} + C, \quad k = 1
      \end{equation}      
      Výsledek platí na každém intervalu neobsahujícím bod \(\alpha\).
      
       U integrálu druhého zlomku 
       \begin{equation}\label{mai:eq137}
        \boxed{\int{\frac{Mx + N}{x^2+px+q}dx}}
      \end{equation} 
       předpokládáme samozřejmě, že kvadratický trojčlen \(x^2+px+q\) nemá kořeny v reálném oboru,
       takže jej nelze rozložit do tvaru \((x - \alpha)(x - \beta)\) s reálnými \(\alpha\),
       \(\beta\) (\cite[p.~140]{Musilova2009MA1}). Platí 
      \begin{gather*}
        \frac{M}{2}\frac{2x + p}{(x^2+px+q)^k} + \left(b - \frac{MN}{2}\right)\frac{1}{(x^2+px+q)^k}
      \end{gather*} 
      K čemu byla předchozí úprava dobrá? Původní parciální zlomek jsme napsali jako součet dvou
      zlomků, z nich je v čitateli derivace funkce \(u(x)=x^2+px+q\). První zlomek se tak stává
      kandidátem na použití substituční metody I.
      \begin{equation*}
        I_1 = \frac{M}{2}\int{\frac{(2x + p)}{(x^2+px+q)^k}dx} = \frac{M}{2}\int\frac{1}{u^k}\dd{u},                   
      \end{equation*}  
      pro \(k\neq1\) dostaneme
      \begin{equation*}
        I_1 = \dfrac{M}{2(1-k)}\dfrac{1}{(x^2+px+q)^{k-1}} + c
      \end{equation*}
      a konečně pro \(k=1\)
      \begin{equation*}
        I_1 = \frac{M}{2}\ln\abs{x^2+px+q} + c
      \end{equation*}
      Při výpočtu durhého integrálu použijeme procedury \uv{doplnění na čtverec}
      (\cite[p.~407]{Rektorys1963}, \cite[s.~264]{Brabec1989}):
      \begin{equation}\label{MA:int_ex_10}
        I_2 =\bigintss{%
                \dfrac{\dd{x}}
                  {\left[\left(x+\frac{p}{2}\right)^2 + q - \left(\frac{p}{2}\right)^2\right]^k}
             }
      \end{equation}
      substitucí $x + p/2 = t\sqrt{q - (p/2)^2}$, \(\dd{x} = \sqrt{q - (p/2)^2}\dd{t}\)
      dostáváme dále
      \begin{gather*}\label{MA:int_ex_11}
        I_2 = \bigintss{%
                \frac{\sqrt{q-\left(\frac{p}{2}\right)^2}}
                    {\left[\left(q-\left(\frac{p}{2}\right)^2\right)(t^2+1)\right]^k}\dd{t}   
        }  
      \end{gather*}
      po úpravě dostaneme integrál 
      \begin{equation*}
        I_2 = 
          \frac{1}{\left(q-\left(\frac{p}{2}\right)^2\right)^{k-\frac{1}{2}}}
          \int{\frac{dt}{\left(t^2+1\right)^k}},
      \end{equation*}

      Zbývá vyřešit nejpracnější problém, určit primitivní funkci ke zlomku \((t^2+1)^{-k}\). Pro
      \(k=1\) je to velmi jednoduché, neboť podle tabulkového integrálu \ref{mai:eq121} dostaneme
      \begin{equation*}\label{MA:int_ex_13}
        \frac{1}{\sqrt{q-\left(\frac{p}{2}\right)^2}}
            \arctan\frac{x+\frac{p}{2}}{\sqrt{q-\left(\frac{p}{2}\right)^2}}.     
      \end{equation*}   
      
      V případě \(k = 2\) vyjádříme integrál
      \begin{equation*}
        \bigintsss{1\cdot\dfrac{1}{(t^2 + 1)^{2}}\dd{t}}
      \end{equation*}
      nikoli jako arkustangentu, ale pomocí metody per partes, pro kterou zvolíme
      \(u'(t)=1\rightarrow u(t)=t\), \(v(t) = \dfrac{1}{t^2+1}\rightarrow v'(t) =
      \dfrac{2t}{(t^2+1)^2}\),
      
      % -----------------------Funkce typu {f(x)=\sqrt{ax+b}} ------------------------------------
      \subsubsection*{Funkce typu $\boxed{f(x)=\sqrt{ax+b}}$ :}
         Funkci, jež je dána rovnicí, jež obsahuje polynomy proměnné x  ve výrazu $\sqrt{ax+b}$,
         v němž $ax+b>0$, $a>0$, integrujeme pomocí substituce:
         \begin{equation}\label{ma:eq_sub_fce1}
             u=\sqrt{ax+b},\quad du=\frac{1}{2}\frac{a}{u}dx,\quad dx=2\frac{u}{a}du
         \end{equation}
         Je-li potřeba dosadit do integrované funkce také za $x$, vyjádříme ze substituční
         rovnice $x=\frac{u^2-b}{a}$.
      % ----------------------Funkce typuf(x)=\frac{1}{\sqrt{x^2+a}}, a\neq0 -------------------- 
      \subsubsection*{Funkce typu $\boxed{f(x)=\frac{1}{\sqrt{x^2+a}}}, a\neq0$ :}
         \begin{example}\label{ma:ex_sub_metoda1}
           \(\int\frac{1}{\sqrt{x^2+a}}\dd{x}\):\vskip0.5mm
           Užijeme \textbf{Eulerovu substituci}: \(u=x+\sqrt{x^2+a}\), a dostáváme
           \(du=\frac{u}{\sqrt{x^2+a}}dx\), \(\frac{du}{u}=\frac{dx}{\sqrt{x^2+a}}\).
           \begin{equation*}
             \int{\frac{1}{\sqrt{x^2+a}}dx}=\int{\frac{du}{u}}=\ln\abs{u}
                                           =\ln\left\lvert x+\sqrt{x^2+a}\right\rvert+C
           \end{equation*}
         \end{example}
  
    % --------------------------Integrály goniometrických funkcí------------------------------------
    \subsubsection{Integrace goniometrických funkcí}
      
    % ---------------- Rozklad ryze lomené funkce v parciální zlomky -------------------------------
    \subsubsection{Rozklad ryze lomené funkce v parciální zlomky}
      Nechť je dána racionální funkce $R = \frac{P}{Q}$ s reálnými koeficienty. Můžeme
      předpokládat, že je \emph{ryze lomená}\footnote{tj. stupeň polynomu $P$ je menší než
      stupeň polynomu $Q$}. Pokud by tomu tak nebylo, dostaneme dělením čitatele jmenovatelem
      zlomku součet polynomu a ryze lomené racionální funkce.

      %-------------------------------------
      \input{../src/MAI/exam/exam128.tex}
      %-------------------------------------

      %-------------------------------------
      \input{../src/MAI/exam/exam129.tex}
      %-------------------------------------
      
      %-------------------------------------
      \input{../src/MAI/exam/exam115.tex}
      %-------------------------------------

  % ---------------- Sbírka řešených příkladů ------------------------------------------------------
  \section{Sbírka řešených příkladů}
    Hledejme primitivní funkce \(F(x)\) k následujícím funkcím
    \begin{enumerate}
      \item \(\int{xe^x\dd{x}}, \quad x\in\realset\),
      \item \(\int\frac{x}{x^2+1}\dd{x}\)
      \item \(\int{\arctan x\dd{x}}, \quad x\in\realset\),
      \item \(\int{\sqrt{x^2+a}\dd{x}}, \quad a\neq0, x^2+a>0\),
      \item \(\int{\frac{2x^4-5x^2+14x+13}{x^2-x-2}\dd{x}} \quad x\in\realset - \{1,2\}\)
    \end{enumerate}

    I když jsme již zdůraznili, že hbitému hledání a nalézání primitivních funkcí se lze naučit 
    jedině praxí, tj. tak, že budeme „počítat, počítat, počítat“, přece jen si ještě ukážeme
    složitější příklady, v nichž se kombinují substituční metody s metodou per partes. Uvidíme však,
    že triky“, které při výpočtu nejvíce pomohou, nespočívají často v těchto metodách samotných, ale
    jsou spíše založeny na představivosti počtáře při úpravě obyčejných středoškolských vzorců.

    \input{../src/MAI/exam/exam112.tex}
    \input{../src/MAI/exam/exam123.tex}
    \input{../src/MAI/exam/exam113.tex}
    \input{../src/MAI/exam/exam114.tex}
    \input{../src/MAI/exam/exam016.tex}
%---------------------------------------------------------------------------------------------------